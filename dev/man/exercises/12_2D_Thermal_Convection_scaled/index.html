<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>12 - 2D Thermal Convection (scaled) · GeoModBox.jl</title><meta name="title" content="12 - 2D Thermal Convection (scaled) · GeoModBox.jl"/><meta property="og:title" content="12 - 2D Thermal Convection (scaled) · GeoModBox.jl"/><meta property="twitter:title" content="12 - 2D Thermal Convection (scaled) · GeoModBox.jl"/><meta name="description" content="Documentation for GeoModBox.jl."/><meta property="og:description" content="Documentation for GeoModBox.jl."/><meta property="twitter:description" content="Documentation for GeoModBox.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">GeoModBox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Governing Equation</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Solution</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../GESolution/">General</a></li><li><a class="tocitem" href="../../Ini/">Initial Condition</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Heat Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../DiffMain/">General</a></li><li><a class="tocitem" href="../../DiffOneD/">1D</a></li><li><a class="tocitem" href="../../DiffTwoD/">2D</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Advection Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../AdvectMain/">General</a></li><li><a class="tocitem" href="../../AdvOneD/">1D</a></li><li><a class="tocitem" href="../../AdvTwoD/">2D</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Momentum Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../MomentumMain/">General</a></li><li><a class="tocitem" href="../../MomentumOneD/">1D</a></li><li><a class="tocitem" href="../../MomentumTwoD/">2D</a></li></ul></li></ul></li><li><span class="tocitem">Exercises</span><ul><li><a class="tocitem" href="../../Exercises/">General</a></li><li><a class="tocitem" href="../01_Euler_Advection/">01 - Euler Advection</a></li><li><a class="tocitem" href="../02_1D_Heat_explicit/">02 - 1D Heat Diffusion (explicit)</a></li><li><a class="tocitem" href="../03_1D_Heat_implicit/">03 - 1D Heat Diffusion (implicit)</a></li><li><a class="tocitem" href="../04_2D_Diffusion_Stationary/">04 - 2D Heat Diffusion (stationary)</a></li><li><a class="tocitem" href="../05_2D_Diffusion_TD_Plume/">05a - 2D Heat Diffusion (Plume)</a></li><li><a class="tocitem" href="../05_2D_Diffusion_TD_Sill/">05b - 2D Heat Diffusion (Sill)</a></li><li><a class="tocitem" href="../06_1D_Advection/">06 - 1D Advection</a></li><li><a class="tocitem" href="../07_2D_Energy_Equation/">07 - 2D Energy Conservation</a></li><li><a class="tocitem" href="../08_1D_Stokes/">08 - 1D Stokes</a></li><li><a class="tocitem" href="../09_2D_Falling_Block/">09 - 2D Falling Block (steady state)</a></li><li><a class="tocitem" href="../10_2D_Falling_Block_td/">10 - 2D Falling Block (time-dep)</a></li><li><a class="tocitem" href="../11_2D_Thermal_Convection/">11 - 2D Thermal Convection</a></li><li class="is-active"><a class="tocitem" href>12 - 2D Thermal Convection (scaled)</a></li><li><a class="tocitem" href="../13_Blankenbach_Benchmark/">13 - Blankenbach Benchmark</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../Examples/">General</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/OceanicGeotherm/">Oceanic Geotherm (1D)</a></li><li><a class="tocitem" href="../../examples/ContinentalGeotherm/">Continental Geotherm (1D)</a></li><li><a class="tocitem" href="../../examples/GaussianDiffusion1D/">Gaussian Diffusion (1D)</a></li><li><a class="tocitem" href="../../examples/BackwardEuler_DC/">Backward Euler (2D)</a></li><li><a class="tocitem" href="../../examples/ForwardEuler_DC/">Forward Euler (2D)</a></li><li><a class="tocitem" href="../../examples/GaussianDiffusion2D/">Gaussian Diffusion (2D)</a></li><li><a class="tocitem" href="../../examples/PoissonRestest/">Poisson Problem (2D)</a></li><li><a class="tocitem" href="../../examples/PoissonVariablek/">Poisson Problem; variable k (2D)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Advection Equtaion</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/Advection2D/">Advection (2D)</a></li><li><a class="tocitem" href="../../examples/AdvectionRestest2D/">Advection Resolution Test (2D)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Stokes Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/ChannelFlow1D/">Channel Flow (1D)</a></li><li><a class="tocitem" href="../../examples/FallingBlockBenchmark/">Falling Block Benchmark</a></li><li><a class="tocitem" href="../../examples/FallingBlockDC/">Falling Block</a></li><li><a class="tocitem" href="../../examples/RTI/">Rayleigh Taylor Instability (RTI)</a></li><li><a class="tocitem" href="../../examples/RTI_growth_rate/">RTI - Growth Rate</a></li><li><a class="tocitem" href="../../examples/ViscousInclusion/">Viscous Inclusion</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Mixed Thermal Convection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/BottomHeatedConvection/">Bottom Heated</a></li><li><a class="tocitem" href="../../examples/InternallyHeatedConvection/">Internally Heated</a></li><li><a class="tocitem" href="../../examples/MixedHeatedConvection/">Mixed Heated</a></li></ul></li></ul></li><li><a class="tocitem" href="../../listoffunctions/">List of functions</a></li><li><a class="tocitem" href="../../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Exercises</a></li><li class="is-active"><a href>12 - 2D Thermal Convection (scaled)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>12 - 2D Thermal Convection (scaled)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GeoSci-FFM/GeoModBox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/docs/src/man/exercises/12_2D_Thermal_Convection_scaled.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="[12-–-2D-Thermal-Convection-(scaled)](https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/exercises/12_2D_Thermal_Convection_scaled_en.ipynb)"><a class="docs-heading-anchor" href="#[12-–-2D-Thermal-Convection-(scaled)](https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/exercises/12_2D_Thermal_Convection_scaled_en.ipynb)"><a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/exercises/12_2D_Thermal_Convection_scaled_en.ipynb">12 – 2D Thermal Convection (scaled)</a></a><a id="[12-–-2D-Thermal-Convection-(scaled)](https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/exercises/12_2D_Thermal_Convection_scaled_en.ipynb)-1"></a><a class="docs-heading-anchor-permalink" href="#[12-–-2D-Thermal-Convection-(scaled)](https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/exercises/12_2D_Thermal_Convection_scaled_en.ipynb)" title="Permalink"></a></h1><p>This exercise revisits <strong>2-D thermal convection</strong> in a fully <strong>nondimensional</strong> (scaled) framework. You will define scaling constants and transform the governing equations, and study how the flow depends on the <strong>Rayleigh number</strong>. The setup follows the <strong>Boussinesq approximation</strong> with isoviscous rheology and bottom heating.</p><p><strong>Objectives</strong></p><ol><li>Define physically motivated <strong>scaling constants</strong> and apply the <strong>nondimensional transformations</strong> to the PDEs.  </li><li>Formulate the <strong>dimensionless</strong> energy, momentum, and mass conservation equations (incl. buoyancy term <span>$Ra,T&#39;$</span>).  </li><li>Implement boundary conditions (Dirichlet/Neumann for temperature; <strong>free-slip</strong> for velocity).  </li><li>Solve the coupled system using finite differences (advection + diffusion + Stokes), leveraging GeoModBox solvers.  </li><li>Run and compare models for <strong><span>$Ra = 10^4, 10^5, 10^6$</span></strong>; discuss plume/slab scale and flow vigor.  </li><li>Compute diagnostics such as <strong>Nusselt number</strong> and <strong>RMS velocity</strong>; assess approach to steady state.</li></ol><p>As the Rayleigh number increases:</p><ul><li><strong>flow velocities</strong> increase,  </li><li><strong>convection becomes more vigorous</strong>, and  </li><li>structures such as <em>slabs</em> and <em>plumes</em> become <strong>finer</strong>.</li></ul><p>Therefore, the <strong>grid resolution</strong> must be adjusted accordingly to ensure <strong>numerical stability</strong> and <strong>accuracy</strong>.</p><blockquote><p>However, higher resolution significantly increases computational cost!</p></blockquote><p>The resolution provided here is sufficient for the Rayleigh numbers listed.   That said, some numerical methods already show <strong>initial inaccuracies</strong>, so in practice a <strong>higher resolution</strong> is often advisable.</p><p><img src="../../../assets/12_ThermalConvection_1.0e6_150_50_lineara_semilag_CNA_dc.gif" alt="Exercise12a"/></p><p><strong>Figure 1.</strong> Isoviscous, bottom-heated thermal convection for <span>$Ra = 10^6$</span> with a resolution of 150x50. The initial condition is a linearly increasing temperature profile with an elliptical anomaly at the top. Thermal boundary conditions are fixed temperature at the top and bottom and zero heat flux at the sides. All velocity boundary conditions are free slip. Heat diffusion is solved using the Crank–Nicolson method, the Stokes equation using the defect correction method, and temperature advection with the semi-Lagrangian method. Models run until a steady state is reached or up to a maximum of 8000 iterations.  </p><p><img src="../../../assets/12_ThermalConvectionTimeSeries_1.0e6_150_50_lineara_semilag_CNA_dc.png" alt="Exercise12b"/></p><p><strong>Figure 2.</strong> Time series of the surface Nusselt number and the root mean square velocity. For details on how these diagnostics are calculated, see the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/exercises/12_2D_Thermal_Convection_en.ipynb">exercise</a>.  </p><p><img src="../../../assets/12_ThermalConvection_iterations_1.0e6_150_50_lineara_semilag_CNA_dc.png" alt="Exercise12c"/></p><p><strong>Figure 3.</strong> Variation in the root mean square velocity with numerical iterations. Empirically, a tolerance of <span>$3.8^{-3}$</span> was chosen to define steady state. Low-<span>$Ra$</span> cases typically reach steady state in fewer than 3000 iterations.  </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../11_2D_Thermal_Convection/">« 11 - 2D Thermal Convection</a><a class="docs-footer-nextpage" href="../13_Blankenbach_Benchmark/">13 - Blankenbach Benchmark »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Monday 3 November 2025 11:08">Monday 3 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
