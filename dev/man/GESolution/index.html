<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>General · GeoModBox.jl</title><meta name="title" content="General · GeoModBox.jl"/><meta property="og:title" content="General · GeoModBox.jl"/><meta property="twitter:title" content="General · GeoModBox.jl"/><meta name="description" content="Documentation for GeoModBox.jl."/><meta property="og:description" content="Documentation for GeoModBox.jl."/><meta property="twitter:description" content="Documentation for GeoModBox.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeoModBox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Governing Equation</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox" checked/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Solution</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>General</a><ul class="internal"><li><a class="tocitem" href="#Governing-Equations"><span>Governing Equations</span></a></li><li><a class="tocitem" href="#Finite-Difference-Method"><span>Finite Difference Method</span></a></li><li><a class="tocitem" href="#Staggered-Finite-Difference"><span>Staggered Finite Difference</span></a></li><li class="toplevel"><a class="tocitem" href="#Initial-Conditions"><span>Initial Conditions</span></a></li><li class="toplevel"><a class="tocitem" href="#Thermal-convection"><span>Thermal convection</span></a></li><li><a class="tocitem" href="#Constitutive-Relation"><span>Constitutive Relation</span></a></li><li><a class="tocitem" href="#Approximations"><span>Approximations</span></a></li><li><a class="tocitem" href="#Scaling"><span>Scaling</span></a></li><li><a class="tocitem" href="#Rayleigh-Number"><span>Rayleigh Number</span></a></li><li><a class="tocitem" href="#Non-Dimensional-Governing-Equations"><span>Non-Dimensional Governing Equations</span></a></li></ul></li><li><a class="tocitem" href="../Ini/">Initial Condition</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Heat Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../DiffMain/">General</a></li><li><a class="tocitem" href="../DiffOneD/">1D</a></li><li><a class="tocitem" href="../DiffTwoD/">2D</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Advection Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../AdvectMain/">General</a></li><li><a class="tocitem" href="../AdvOneD/">1D</a></li><li><a class="tocitem" href="../AdvTwoD/">2D</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Momentum Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../MomentumMain/">General</a></li><li><a class="tocitem" href="../MomentumOneD/">1D</a></li><li><a class="tocitem" href="../MomentumTwoD/">2D</a></li></ul></li></ul></li><li><span class="tocitem">Exercises</span><ul><li><a class="tocitem" href="../Exercises/">General</a></li><li><a class="tocitem" href="../exercises/01_Euler_Advection/">01 - Euler Advection</a></li><li><a class="tocitem" href="../exercises/02_1D_Heat_explicit/">02 - 1D Heat Diffusion (explicit)</a></li><li><a class="tocitem" href="../exercises/03_1D_Heat_implicit/">03 - 1D Heat Diffusion (implicit)</a></li><li><a class="tocitem" href="../exercises/04_2D_Diffusion_Stationary/">04 - 2D Heat Diffusion (stationary)</a></li><li><a class="tocitem" href="../exercises/05_2D_Diffusion_TD_Plume/">05a - 2D Heat Diffusion (Plume)</a></li><li><a class="tocitem" href="../exercises/05_2D_Diffusion_TD_Sill/">05b - 2D Heat Diffusion (Sill)</a></li><li><a class="tocitem" href="../exercises/06_1D_Advection/">06 - 1D Advection</a></li><li><a class="tocitem" href="../exercises/07_2D_Energy_Equation/">07 - 2D Energy Conservation</a></li><li><a class="tocitem" href="../exercises/08_1D_Stokes/">08 - 1D Stokes</a></li><li><a class="tocitem" href="../exercises/09_2D_Falling_Block/">09 - 2D Falling Block (steady state)</a></li><li><a class="tocitem" href="../exercises/10_2D_Falling_Block_td/">10 - 2D Falling Block (time-dep)</a></li><li><a class="tocitem" href="../exercises/11_2D_Thermal_Convection/">11 - 2D Thermal Convection</a></li><li><a class="tocitem" href="../exercises/12_2D_Thermal_Convection_scaled/">12 - 2D Thermal Convection (scaled)</a></li><li><a class="tocitem" href="../exercises/13_Blankenbach_Benchmark/">13 - Blankenbach Benchmark</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../Examples/">General</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/OceanicGeotherm/">Oceanic Geotherm (1D)</a></li><li><a class="tocitem" href="../examples/ContinentalGeotherm/">Continental Geotherm (1D)</a></li><li><a class="tocitem" href="../examples/GaussianDiffusion1D/">Gaussian Diffusion (1D)</a></li><li><a class="tocitem" href="../examples/BackwardEuler_DC/">Backward Euler (2D)</a></li><li><a class="tocitem" href="../examples/ForwardEuler_DC/">Forward Euler (2D)</a></li><li><a class="tocitem" href="../examples/GaussianDiffusion2D/">Gaussian Diffusion (2D)</a></li><li><a class="tocitem" href="../examples/PoissonRestest/">Poisson Problem (2D)</a></li><li><a class="tocitem" href="../examples/PoissonVariablek/">Poisson Problem; variable k (2D)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Advection Equtaion</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/Advection2D/">Advection (2D)</a></li><li><a class="tocitem" href="../examples/AdvectionRestest2D/">Advection Resolution Test (2D)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Stokes Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/ChannelFlow1D/">Channel Flow (1D)</a></li><li><a class="tocitem" href="../examples/FallingBlockBenchmark/">Falling Block Benchmark</a></li><li><a class="tocitem" href="../examples/FallingBlockDC/">Falling Block</a></li><li><a class="tocitem" href="../examples/RTI/">Rayleigh Taylor Instability (RTI)</a></li><li><a class="tocitem" href="../examples/RTI_growth_rate/">RTI - Growth Rate</a></li><li><a class="tocitem" href="../examples/ViscousInclusion/">Viscous Inclusion</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Mixed Thermal Convection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/BottomHeatedConvection/">Bottom Heated</a></li><li><a class="tocitem" href="../examples/InternallyHeatedConvection/">Internally Heated</a></li><li><a class="tocitem" href="../examples/MixedHeatedConvection/">Mixed Heated</a></li></ul></li></ul></li><li><a class="tocitem" href="../listoffunctions/">List of functions</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Governing Equation</a></li><li><a class="is-disabled">Solution</a></li><li class="is-active"><a href>General</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>General</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GeoSci-FFM/GeoModBox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/docs/src/man/GESolution.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Solving-Differential-Equations"><a class="docs-heading-anchor" href="#Solving-Differential-Equations">Solving Differential Equations</a><a id="Solving-Differential-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-Differential-Equations" title="Permalink"></a></h1><h2 id="Governing-Equations"><a class="docs-heading-anchor" href="#Governing-Equations">Governing Equations</a><a id="Governing-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Governing-Equations" title="Permalink"></a></h2><p>The governing equations for solving geodynamical problems—neglecting adiabatic effects and assuming only radioactive heat sources—are given by the conservation laws of </p><p><strong>Momentum</strong></p><p class="math-container">\[\begin{equation}
\rho \left(\frac{\partial{v_{i}}}{\partial{t}} + v_{j}\frac{\partial{v_{i}}}{\partial{x_{j}}}\right) = -\frac{\partial{P_t}}{\partial{x_{i}}} + \frac{\partial{\tau_{ij}}}{\partial{x_j}} + \rho g_{i},
\end{equation}\]</p><p>where  <span>$\rho$</span> is the density [kg/m³],  <span>$v_i$</span> is the velocity in the <span>$i$</span>-th direction [m/s], <span>$t$</span> is time [s], <span>$\partial/\partial{t}$</span> is the time derivative,  <span>$\partial/\partial x_i$</span> is a directional derivative in <span>$i$</span>,  <span>$P_t$</span> is the total pressure [Pa],  <span>$\tau_{ij}$</span> is the deviatoric stress tensor [Pa], and  <span>$\boldsymbol{g}$</span> is the gravitational acceleration vector [m/s²]. </p><p><strong>Energy</strong></p><p class="math-container">\[\begin{equation}
\rho c_p \left(\frac{\partial T}{\partial t} + v_j\frac{\partial{T}}{\partial{x_j}}\right) = -\frac{\partial q_i}{\partial x_i} + \rho H,
\end{equation}\]</p><p>where  <span>$c_p$</span> is the specific heat capacity [J/kg/K], <span>$T$</span> is temperature [K], <span>$q_i$</span> is the heat flux [W/m²] in direction <span>$i$</span>, <span>$H$</span> is the internal heat production per unit mass [W/kg]. </p><p><strong>Mass</strong></p><p class="math-container">\[\begin{equation}
\frac{\partial{v_i}}{\partial{x_i}} = 0.
\end{equation}\]</p><p>Repeated indices imply summation.</p><p>Ordinary and partial differential equations (ODEs and PDEs) can be solved through various approaches—occasionally <em>analytically</em>, but more commonly <em>numerically</em> due to their inherent complexity. Among numerical methods, prominent techniques include <em>integral</em>-based methods, such as the <em>finite element</em> and <em>spectral</em> methods, as well as the <em>finite difference</em> method.</p><h2 id="Finite-Difference-Method"><a class="docs-heading-anchor" href="#Finite-Difference-Method">Finite Difference Method</a><a id="Finite-Difference-Method-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-Difference-Method" title="Permalink"></a></h2><p>The <code>GeoModBox.jl</code> framework employs the <strong>finite difference method</strong>. While each numerical approach has its own strengths and limitations, the choice often depends on the user&#39;s familiarity and comfort with the method. Nonetheless, the finite difference method is relatively straightforward and pedagogically advantageous, as its discretized form closely resembles the original differential equations. Furthermore, it is computationally efficient, making it well-suited for performance-critical applications.</p><p>In general, the finite difference method aims to approximate <strong>differential operators</strong> using finite differences derived from a Taylor series expansion. </p><p><strong>Mathematical Background</strong></p><p>In infinitesimal calculus,the interest lies in how a quantity, such as <span>$u$</span>, changes in response to a small variation in the variable <span>$x$</span>. If <span>$u$</span> has a value of <span>$u_0$</span> at position <span>$x_0$</span> and changes to <span>$u_0 + \delta{u}$</span> when <span>$x$</span> changes to x_0 + \delta{x}, the incremental change can be described as follows:</p><p class="math-container">\[\begin{equation}
\delta{u} = \frac{\delta{u}}{\delta{x}}\left(x_0\right)\delta{x}. 
\end{equation}\]</p><p>Here, <span>$\delta$</span> denotes a small but finite change. When <span>$\delta{x}$</span> decreases asymptotically toward 0 near <span>$x_0$</span>, the partial derivative is obtained:</p><p class="math-container">\[\begin{equation}
\lim_{\delta \to 0} \frac{\delta{u}}{\delta{x}}\left(x_0\right) = \frac{\partial{u}}{\partial{x}}.
\end{equation}\]</p><p>This limit is valid provided there are no discontinuities or abrupt changes in <span>$u$</span> with respect to <span>$x$</span>.</p><p>The finite difference formulation permits the utilization of arithmetic (computational) operators to ascertain the derivatives. Finite difference formulations are predicated on a Taylor series expansion with truncation to a certain order. In general, a Taylor series expansion is given as </p><p class="math-container">\[\begin{equation}
u(x) = u(x_0)+\frac{\partial{u}}{\partial{x}}(x_0)(x-x_0)+\frac{\partial^2{u}}{\partial{x^2}}(x_0)\frac{\left(x-x_0\right)^2}{2!}+\frac{\partial^3{u}}{\partial{x^3}}(x_0)\frac{\left(x-x_0\right)^3}{3!}+ \dots + +\frac{\partial^n{u}}{\partial{x^n}}(x_0)\frac{\left(x-x_0\right)^n}{n!},
\end{equation}\]</p><p>where <span>$\frac{\partial^2{u}}{\partial{x^2}}$</span> is the second derivative and <span>$n!$</span> describes the factorial, that is: </p><p class="math-container">\[\begin{equation}
n! = 1 \times 2 \times 3 \times \dots \times n.
\end{equation}\]</p><p>Rearranging the Taylor series extension and neglecting higher order terms one obtains an approximation of the partial derivatives using finite difference formulations as </p><p class="math-container">\[\begin{equation}
\frac{\partial{u}}{\partial{x}}(x_0) = \frac{u(x_0)-u(x)}{\left(x-x_0\right)} + \cal{O}\left(\Delta{x}\right) = \frac{u(x_0)-u(x_0+\Delta{x})}{\Delta{x}} + \cal{O}\left(\Delta{x}\right),
\end{equation}\]</p><p>where <span>$\cal{O}$</span> indicates the truncation error of the approximation (here, <span>$\Delta{x}$</span>), and the formulation is, by definition, only accurate up to the first order.</p><p>The partial derivatives can be approximated via different finite differences as </p><p class="math-container">\[\begin{equation}\begin{split}
\textrm{forward difference} &amp;: \quad \frac{\partial{u}}{\partial{x}}\vert_{i,j} = \frac{u(x+\Delta{x})-u(x)}{\Delta{x}} + \cal{O}\left(\Delta{x}\right) = \frac{u_{i+1,j}-u_{i,j}}{\Delta{x}} + \cal{O}\left(\Delta{x}\right) \\ \newline
\textrm{central difference} &amp;: \quad \frac{\partial{u}}{\partial{x}}\vert_{i,j} = \frac{u(x+\Delta{x})-u(x-\Delta{x})}{2\Delta{x}} + \cal{O}\left(\Delta{x^2}\right) = \frac{u_{i+1,j}-u_{i-1,j}}{2\Delta{x}} + \cal{O}\left(\Delta{x^2}\right) \\ \newline
\textrm{backward difference} &amp;: \quad \frac{\partial{u}}{\partial{x}}\vert_{i,j} = \frac{u(x)-u(x-\Delta{x})}{\Delta{x}} + \cal{O}\left(\Delta{x}\right) = \frac{u_{i,j}-u_{i-1,j}}{\Delta{x}} + \cal{O}\left(\Delta{x}\right) \\
\end{split}\end{equation}\]</p><p>For further details, refer to the <a href="https://lukasfuchs.wordpress.com/numerical-methods-in-geophysics/">lecture notes</a> or see the reference below.</p><h2 id="Staggered-Finite-Difference"><a class="docs-heading-anchor" href="#Staggered-Finite-Difference">Staggered Finite Difference</a><a id="Staggered-Finite-Difference-1"></a><a class="docs-heading-anchor-permalink" href="#Staggered-Finite-Difference" title="Permalink"></a></h2><p>To solve differential equations within a given domain using the finite difference method, it is first necessary to generate a <em>numerical grid</em> on which finite differences can be computed. The most straightforward approach is to discretize the domain using a <em>regular</em>, <em>uniform</em> grid, where the spacing between grid points is constant and all variables are defined at the same locations. Such grids are commonly used to solve equations like the Poisson equation, the heat equation, or advective transport equations.</p><p>However, in many cases, physical constraints or numerical stability requirements necessitate an alternative arrangement of variable locations. For example, solving the <em>momentum equation</em> with <strong>variable viscosity</strong> generally requires a <em>fully staggered grid</em> to ensure continuity of stress across adjacent grid points. A similar consideration applies to the <em>temperature equation</em> when using <strong>variable thermal conductivity</strong>.</p><p>Staggered grids also offer advantages in implementing boundary conditions. For example, with <em>Neumann</em> thermal boundary conditions, the heat flux across a boundary can be naturally evaluated at staggered points using so-called <em>ghost points</em>. These ghost points can also be employed to impose <em>Dirichlet</em> boundary conditions. This approach helps maintain consistent accuracy and the order of the finite difference scheme both at internal and boundary points. </p><p>For these reasons, <code>GeoModBox.jl</code> adopts a staggered grid for solving the temperature equation. The complete grid structure used for the governing equations in <code>GeoModBox.jl</code> is illustrated below:</p><p><img src="../../assets/Grid_total.png" alt="2DGrid_total"/></p><p><strong>Figure 1. Staggered Finite Difference Grid used in ´GeoModBox.jl`.</strong></p><h1 id="Initial-Conditions"><a class="docs-heading-anchor" href="#Initial-Conditions">Initial Conditions</a><a id="Initial-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-Conditions" title="Permalink"></a></h1><p>Certain initial conditions and parameter structures are already defined in <code>GeoModBox.jl</code> and can be called using certain functions. For more details on the variable structures and functions for initial conditions please see this <a href="../Ini/">documentation</a>. </p><h1 id="Thermal-convection"><a class="docs-heading-anchor" href="#Thermal-convection">Thermal convection</a><a id="Thermal-convection-1"></a><a class="docs-heading-anchor-permalink" href="#Thermal-convection" title="Permalink"></a></h1><p>The equations discussed here are used to solve for pressure and velocity in two-dimensional thermal convection systems. While support for variable thermodynamic parameters—such as density (<span>$\rho$</span>), specific heat capacity (<span>$c_p$</span>), and thermal conductivity (<span>$k$</span>)—is forthcoming, simplifications are often employed to make the problem more tractable.</p><h2 id="Constitutive-Relation"><a class="docs-heading-anchor" href="#Constitutive-Relation">Constitutive Relation</a><a id="Constitutive-Relation-1"></a><a class="docs-heading-anchor-permalink" href="#Constitutive-Relation" title="Permalink"></a></h2><p>The constitutive equations of rheology delineate a relationship between the second-order tensor for the kinematics <span>$\left(\text{Strain rate: }\dot{\varepsilon}, \text{Strain: } \varepsilon \right)$</span> and the dynamics <span>$\left(\text{Forces}, \text{Stresses: }\sigma\right)$</span>. Several constitutive models are commonly employed (e.g., viscous, elastic, viscoelastic, plastic). In <code>GeoModBox.jl</code>, the focus is on incompressible, viscous rheology, described by: </p><p class="math-container">\[\begin{equation}
\tau_{ij} = 2\eta \cdot \dot{\varepsilon}_{ij},
\end{equation}\]</p><p>where <span>$\eta$</span> is the dynamic viscosity [Pa·s] and <span>$\tau_{ij}$</span> is the deviatoric stress tensor [Pa] defined as </p><p class="math-container">\[\begin{equation}
\tau_{ij} = \sigma_{ij} + P\delta{}_{ij},
\end{equation}\]</p><p>where <span>$\sigma_{ij}$</span> is the full stress tensor [Pa], <span>$P$</span> is the pressure [Pa], and <span>$\delta$</span> is the <em>Kronecker Delta</em>. </p><h2 id="Approximations"><a class="docs-heading-anchor" href="#Approximations">Approximations</a><a id="Approximations-1"></a><a class="docs-heading-anchor-permalink" href="#Approximations" title="Permalink"></a></h2><p>A commonly used simplification in thermal convection modeling is the <em>Boussinesq</em> approximation. This approximation assumes that all thermodynamic properties remain constant, and adiabatic temperature effects are neglected in the temperature equation. Spatial density variations are assumed to be small and are only retained in the buoyancy term of the momentum equation. Under this framework, density becomes a function of temperature and is described using an <em>equation of state</em>.</p><h3 id="Equation-of-State"><a class="docs-heading-anchor" href="#Equation-of-State">Equation of State</a><a id="Equation-of-State-1"></a><a class="docs-heading-anchor-permalink" href="#Equation-of-State" title="Permalink"></a></h3><p>Various forms of the <em>equation of state</em> are available. In this context, a linear approximation is used to relate density to temperature:</p><p class="math-container">\[\begin{equation}
\rho = \rho_0 (1-\alpha T),
\end{equation}\]</p><p>where <span>$\rho_0$</span> is the reference density [kg/m³], and <span>$\alpha$</span> is the thermal expansion coefficient [1/K].</p><p>Substituting this relation into the buoyancy term on the right-hand side of the momentum equation and using the definition of total pressure,</p><p class="math-container">\[\begin{equation}
P_t = P_{\text{dyn}} + P_{\text{hydr}},
\end{equation}\]</p><p>where <span>$P_{\text{dyn}}$</span> and <span>$P_{\text{hydr}}$</span> denote the dynamic and hydrostatic pressure [Pa], respectively, along with the gradient of hydrostatic pressure,</p><p class="math-container">\[\begin{equation}
\frac{\partial{P_{\text{hydr}}}}{\partial{y}}=\rho_0 g,
\end{equation}\]</p><p>yields a modified form of the <span>$y$</span>-component of the dimensional momentum equation.</p><h3 id="Governing-equations"><a class="docs-heading-anchor" href="#Governing-equations">Governing equations</a><a id="Governing-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Governing-equations" title="Permalink"></a></h3><p>The following dimensional equations govern thermal convection under the <em>Boussinesq</em> approximation:</p><p><strong>Momentum equation</strong></p><p><em><span>$x$</span>-component</em></p><p class="math-container">\[\begin{equation}
0 = -\frac{\partial{P_{\text{dyn}}}}{\partial{x}}+\frac{\partial{\tau_{xj}}}{\partial{x_j}},
\end{equation}\]</p><p><em><span>$y$</span>-component</em></p><p class="math-container">\[\begin{equation}
0 = -\frac{\partial{P_{\text{dyn}}}}{\partial{y}}+\frac{\partial{\tau_{yj}}}{\partial{x_j}} - \rho_0 g \alpha T,
\end{equation}\]</p><p>where <span>$P_{\text{dyn}}$</span> is the dynamic pressure [Pa], <span>$\tau_{ij}$</span> is the deviatoric stress tensor [Pa], <span>$\rho_0$</span> is the reference density [kg/m³], <span>$g$</span> is the gravitational acceleration [m/s²], <span>$\alpha$</span> is the thermal expansion coefficient [1/K], and <span>$T$</span> is the absolute temperature [K].</p><p><strong>Temperature equation</strong></p><p class="math-container">\[\begin{equation}
\left(\frac{\partial{T}}{\partial{t}} + v_j \frac{\partial{T}}{\partial{x_j}}\right) = \kappa \frac{\partial^2{T}}{\partial{x^2_i}} + \frac{Q}{\rho_0 c_p},
\end{equation}\]</p><p>where <span>$t$</span> is time [s], <span>$v_j$</span> is the velocity in the <span>$j$</span>-th direction [m/s], <span>$\kappa = \frac{k}{\rho c_p}$</span> is the thermal diffusivity [m²/s], <span>$Q$</span> is the volumetric heat production rate [W/m³], and <span>$c_p$</span> is the specific heat capacity [J/kg/K]. For implementation details, refer to the <a href="../examples/MixedHeatedConvection/">thermal convection examples</a>.</p><p><strong>Continuity equation</strong></p><p class="math-container">\[\begin{equation}
\frac{\partial{v_i}}{\partial{x_i}} = 0.
\end{equation}\]</p><h2 id="Scaling"><a class="docs-heading-anchor" href="#Scaling">Scaling</a><a id="Scaling-1"></a><a class="docs-heading-anchor-permalink" href="#Scaling" title="Permalink"></a></h2><p>In geodynamic modeling, it is common practice to non-dimensionalize the governing equations to generalize results across different physical scales and to enable experimental modeling (e.g., in laboratory settings). To non-dimensionalize equations (15)–(18), certain <em>scaling constants</em> are introduced and the associated <em>scaling laws</em> derived.</p><h3 id="Scaling-Constants"><a class="docs-heading-anchor" href="#Scaling-Constants">Scaling Constants</a><a id="Scaling-Constants-1"></a><a class="docs-heading-anchor-permalink" href="#Scaling-Constants" title="Permalink"></a></h3><p>Various approaches exist for non-dimensionalization. Here, the following set of scaling constants are adopted:</p><p class="math-container">\[\begin{equation}\begin{split}
h_{sc} &amp; = h, \\ 
t_{sc} &amp; = \frac{h^2}{\kappa}, \\
v_{sc} &amp; = \frac{\kappa}{h}, \\
\tau_{sc} &amp; = \frac{\eta_0 \kappa}{h^2}, \\
T_{sc} &amp; = \Delta{T}, \\
Q_{sc} &amp; = \frac{\Delta{T}\kappa \rho_0 c_p}{h^2}, 
\end{split}\end{equation}\]</p><p>where <span>$h$</span> is the model height [m], <span>$\kappa$</span> is the thermal diffusivity [m²/s], <span>$\eta_0$</span> is the reference viscosity [Pa·s], <span>$\Delta T$</span> is the temperature difference between the top and bottom boundaries [K], <span>$\rho_0$</span> is the reference density [kg/m³], and <span>$c_p$</span> is the specific heat capacity [J/kg/K].</p><h3 id="Scaling-laws"><a class="docs-heading-anchor" href="#Scaling-laws">Scaling laws</a><a id="Scaling-laws-1"></a><a class="docs-heading-anchor-permalink" href="#Scaling-laws" title="Permalink"></a></h3><p>These constants are applied to transform dimensional quantities into their non-dimensional counterparts (apostrophe indicates non-dimensional parameters):</p><p class="math-container">\[\begin{equation}\begin{split}
h &amp; = h&#39; \cdot h_{sc}, \\ 
t &amp; = t&#39; \cdot t_{sc}, \\
v &amp; = v&#39; \cdot v_{sc}, \\
\tau &amp; = \tau&#39; \cdot \tau_{sc}, \\
T &amp; = T&#39; \cdot T_{sc}, \\
Q &amp; = Q&#39; \cdot Q_{sc}.
\end{split}\end{equation}\]</p><p>When applied, many of the constants cancel out, resulting in non-dimensional equations that structurally resemble the dimensional ones.</p><blockquote><p><strong>Note:</strong> This simplification is only valid under the assumptions and approximations discussed above. Any remaining scaling terms can often be grouped into key dimensionless parameters.</p></blockquote><h2 id="Rayleigh-Number"><a class="docs-heading-anchor" href="#Rayleigh-Number">Rayleigh Number</a><a id="Rayleigh-Number-1"></a><a class="docs-heading-anchor-permalink" href="#Rayleigh-Number" title="Permalink"></a></h2><p>The primary remaining dimensionless parameter is the Rayleigh number (<span>$Ra$</span>), which characterizes the convective behavior and replaces the buoyancy term in the momentum equation:</p><p class="math-container">\[\begin{equation}
Ra = \frac{\rho_0 g \alpha \Delta{T} h^3}{\eta_0 \kappa}.
\end{equation}\]</p><h2 id="Non-Dimensional-Governing-Equations"><a class="docs-heading-anchor" href="#Non-Dimensional-Governing-Equations">Non-Dimensional Governing Equations</a><a id="Non-Dimensional-Governing-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Non-Dimensional-Governing-Equations" title="Permalink"></a></h2><p>The non-dimensional governing equations are then defined as: </p><p><strong>Momentum equation</strong></p><p><em><span>$x$</span>-component</em></p><p class="math-container">\[\begin{equation}
-\frac{\partial{P&#39;}}{\partial{x&#39;}}+\frac{\partial{\tau_{xj}&#39;}}{\partial{x_j&#39;}} = 0,
\end{equation}\]</p><p>Or in terms of velocity: </p><p class="math-container">\[\begin{equation}
-\frac{\partial{P&#39;}}{\partial{x&#39;}}+2\frac{\partial}{\partial{x&#39;}}\eta&#39;\frac{\partial{v_x&#39;}}{\partial{x&#39;}}+\frac{\partial}{\partial{y&#39;}}\eta&#39;\left(\frac{\partial{v_x&#39;}}{\partial{y&#39;}}+\frac{\partial{v_y&#39;}}{\partial{x&#39;}}\right) = 0.
\end{equation}\]</p><p><em><span>$y$</span>-component</em></p><p class="math-container">\[\begin{equation}
-\frac{\partial{P&#39;}}{\partial{y&#39;}}+\frac{\partial{\tau_{yj}&#39;}}{\partial{x_j&#39;}} = Ra T&#39;,
\end{equation}\]</p><p>Or in terms of velocity: </p><p class="math-container">\[\begin{equation}
-\frac{\partial{P&#39;}}{\partial{y&#39;}}+2\frac{\partial}{\partial{y&#39;}}\eta&#39;\frac{\partial{v_{y}&#39;}}{\partial{y&#39;}} +\frac{\partial}{\partial{x&#39;}}\eta&#39;\left(\frac{\partial{v_{y}&#39;}}{\partial{x&#39;}} + \frac{\partial{v_{x}&#39;}}{\partial{y&#39;}}\right) = Ra T&#39;.
\end{equation}\]</p><p><strong>Temperature equation</strong></p><p class="math-container">\[\begin{equation}
\left(\frac{\partial{T&#39;}}{\partial{t&#39;}} + v_j&#39; \frac{\partial{T&#39;}}{\partial{x_j&#39;}}\right) = \frac{\partial^2{T&#39;}}{\partial{x^{&#39;2}_i}} + Q&#39;.
\end{equation}\]</p><p><strong>Continuity equation</strong></p><p class="math-container">\[\begin{equation}
\frac{\partial{v&#39;_x}}{\partial{x&#39;}} + \frac{\partial{v&#39;_y}}{\partial{y&#39;}} = 0.
\end{equation}\]</p><p>When interpreting or analyzing non-dimensional models, it is essential to keep track of the scaling constants and reference values used in the transformation.</p><p>Compared to the dimensional equations, the non-dimensional (scaled) forms differ only slightly in structure. As a result, the same numerical solver can be used for both dimensional and non-dimensional formulations, requiring only minimal modifications when specifying the parameters. </p><p>For an implementation example, see the <a href="../examples/MixedHeatedConvection/">thermal convection examples</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../Ini/">Initial Condition »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 7 October 2025 20:13">Tuesday 7 October 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
