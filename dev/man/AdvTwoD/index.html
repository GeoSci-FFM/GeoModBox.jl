<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Advection Equation (2D) · GeoModBox.jl</title><meta name="title" content="Advection Equation (2D) · GeoModBox.jl"/><meta property="og:title" content="Advection Equation (2D) · GeoModBox.jl"/><meta property="twitter:title" content="Advection Equation (2D) · GeoModBox.jl"/><meta name="description" content="Documentation for GeoModBox.jl."/><meta property="og:description" content="Documentation for GeoModBox.jl."/><meta property="twitter:description" content="Documentation for GeoModBox.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeoModBox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Governing Equation</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Solution</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../GESolution/">General</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Heat Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../DiffMain/">General</a></li><li><a class="tocitem" href="../DiffOneD/">1D</a></li><li><a class="tocitem" href="../DiffTwoD/">2D</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Advection Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../AdvectMain/">General</a></li><li><a class="tocitem" href="../AdvOneD/">1D</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Momentum Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../MomentumMain/">General</a></li><li><a class="tocitem" href="../MomentumOneD/">1D</a></li><li><a class="tocitem" href="../MomentumTwoD/">2D</a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/OceanicGeotherm/">Oceanic Geotherm (1D)</a></li><li><a class="tocitem" href="../examples/ContinentalGeotherm/">Continental Geotherm (1D)</a></li><li><a class="tocitem" href="../examples/GaussianDiffusion1D/">Gaussian Diffusion (1D)</a></li><li><a class="tocitem" href="../examples/BackwardEuler_DC/">Backward Euler (2D)</a></li><li><a class="tocitem" href="../examples/ForwardEuler_DC/">Forward Euler (2D)</a></li><li><a class="tocitem" href="../examples/GaussianDiffusion2D/">Gaussian Diffusion (2D)</a></li><li><a class="tocitem" href="../examples/PoissonRestest/">Poisson Problem (2D)</a></li><li><a class="tocitem" href="../examples/PoissonVariablek/">Poisson Problem; variable k (2D)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Advection Equtaion</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/Advection2D/">Advection (2D)</a></li><li><a class="tocitem" href="../examples/AdvectionRestest2D/">Advection Resolution Test (2D)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Stokes Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/ChannelFlow1D/">Channel Flow (1D)</a></li><li><a class="tocitem" href="../examples/FallingBlockBenchmark/">Falling Block Benchmark</a></li><li><a class="tocitem" href="../examples/FallingBlockDC/">Falling Block</a></li><li><a class="tocitem" href="../examples/RTI/">Rayleigh Taylor Instability</a></li><li><a class="tocitem" href="../examples/ViscousInclusion/">Viscous Inclusion</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Mixed Thermal Convection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/BottomHeatedConvection/">Bottom Heated</a></li><li><a class="tocitem" href="../examples/InternallyHeatedConvection/">Internally Heated</a></li><li><a class="tocitem" href="../examples/MixedHeatedConvection/">Mixed Heated</a></li></ul></li></ul></li><li><a class="tocitem" href="../listoffunctions/">List of functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Advection Equation (2D)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Advection Equation (2D)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GeoSci-FFM/GeoModBox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/docs/src/man/AdvTwoD.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Advection-Equation-(2D)"><a class="docs-heading-anchor" href="#Advection-Equation-(2D)">Advection Equation (2D)</a><a id="Advection-Equation-(2D)-1"></a><a class="docs-heading-anchor-permalink" href="#Advection-Equation-(2D)" title="Permalink"></a></h1><h1 id="Discretization-Schemes"><a class="docs-heading-anchor" href="#Discretization-Schemes">Discretization Schemes</a><a id="Discretization-Schemes-1"></a><a class="docs-heading-anchor-permalink" href="#Discretization-Schemes" title="Permalink"></a></h1><h2 id="The-Upwind-Scheme"><a class="docs-heading-anchor" href="#The-Upwind-Scheme">The Upwind Scheme</a><a id="The-Upwind-Scheme-1"></a><a class="docs-heading-anchor-permalink" href="#The-Upwind-Scheme" title="Permalink"></a></h2><p>The idea is that the flux into the local cell will only depend on the gradient of temperature in the direction upstream. The upwind scheme is similar to a <em>FTCS</em> discretization, however, the central spacial derivatives are replaced by single-sided forward and backward finite differences and one needs to consider the advection velocity as well, to ensure that the discretization in space is always upstream. In 2-D the advection equation is then given as: </p><p class="math-container">\[\begin{equation}
\frac{T_{i,j}^{n+1}-T_{i,j}^n}{\Delta t}=-v_{x;i,j}\cases{\matrix{\frac{T_{i,j}^{n}-T_{i,j-1}^n}{\Delta x} \quad \text{if} \quad v_{x;i,j} &gt; 0 \\\ \frac{T_{i,j+1}^{n}-T_{i,j}^n}{\Delta x} \quad \text{if} \quad v_{x;i,j}&lt;0}} 
-v_{z;i,j}\cases{\matrix{\frac{T_{i,j}^{n}-T_{i-1,j}^n}{\Delta z} \quad \text{if} \quad v_{z;i,j} &gt; 0 \\\ \frac{T_{i+1,j}^{n}-T_{i,j}^n}{\Delta z} \quad \text{if} \quad v_{z;i,j}&lt;0}},
\end{equation}\]</p><p>where <span>$T$</span> is the temperature, <span>$v$</span> the velocity, <span>$n$</span> is the current time step, <span>$\Delta t$</span> the time step increment, and <span>$i$</span> and <span>$j$</span> are the indices in <span>$z$</span>- and <span>$x$</span>- direction, respectively. For more details see [<em>UpwindAdvection2D.m</em>].</p><p>This is a stable and effective way, however, with a certain amount of numerical diffusion if the <em>courant criteria</em> is not fulfilled and only first order accurate in space. The courant criteria implies that the time step is smaller than the minimum grid spacing divided by the maximum velocity, that is, a property should not be advected over a distance larger than the grid spacing, or:</p><p class="math-container">\[\begin{equation}
\Delta t \le \frac{\Delta x}{max(|v|)}.
\end{equation}\]</p><h2 id="The-Staggered-Leapfrog-(SLF)-Scheme"><a class="docs-heading-anchor" href="#The-Staggered-Leapfrog-(SLF)-Scheme">The Staggered Leapfrog (SLF) Scheme</a><a id="The-Staggered-Leapfrog-(SLF)-Scheme-1"></a><a class="docs-heading-anchor-permalink" href="#The-Staggered-Leapfrog-(SLF)-Scheme" title="Permalink"></a></h2><p>This method considers a centered in time and centered in space discretization of the partial differentials, thus it has a higher order of accuracy in space (second order) and is suppose to not have any numerical diffusion. In 2-D the advection equation discretizes to:</p><p class="math-container">\[\begin{equation}
\frac{T_{i,j}^{n+1} - T_{i,j}^{n-1}}{2\Delta t}=-v_{x;i,j}\frac{T_{i,j+1}^{n} - T_{i,j-1}^{n}}{2\Delta x}-v_{z;i,j}\frac{T_{i+1,j}^{n} - T_{i-1,j}^{n}}{2\Delta z}.
\end{equation}\]</p><p>For more details see [SLFAdvection2D.m].</p><h2 id="The-semi-lagragian-scheme"><a class="docs-heading-anchor" href="#The-semi-lagragian-scheme">The semi-lagragian scheme</a><a id="The-semi-lagragian-scheme-1"></a><a class="docs-heading-anchor-permalink" href="#The-semi-lagragian-scheme" title="Permalink"></a></h2><p>This method is related to the tracer-based advection by solving ordinary differential equations (<em>ODEs</em>), where it assumes that <em>imaginary tracers</em> are located at certain positions and land directly at the finite difference grid nodes after advection within one time step. Thus, one needs to calculate the <em>origin points</em> for each grid node back in time (e.g., one Euler time step) with a given velocity field (e.g., using an <em>iterative mid-point scheme</em>, i.e. one uses the velocity at a point half a time step backward in time) and then to interpolate the property from the regular grid points to the determined <em>origin points</em>. This scheme assumes that no heat-sources were active during the advection. The method does not have any numerical diffusion but shows inaccuracies due to the interpolation method. For more details see [SemiLagAdvection2D.m].</p><ul><li>central point iteration</li></ul><h2 id="Passive-tracers"><a class="docs-heading-anchor" href="#Passive-tracers">Passive tracers</a><a id="Passive-tracers-1"></a><a class="docs-heading-anchor-permalink" href="#Passive-tracers" title="Permalink"></a></h2><p>Here, one assumes that the model domain is completely filled with so-called <em>tracers</em> or <em>markers</em>. These tracers are then advected by solving the <em>ODE</em> of a particle advection using a certain method (e.g., Euler or Runge Kutta) and they transport any property stored on them. However, care needs to be taken when interpolating those properties from the regular grid onto the tracers and back. This is even more complex if the property advected does have an effect on parameters controlling the governing equations (e.g., the viscosity in continuum euqation).</p><p>Here, I advect the tracers using Runge-Kutta fourth order; the tracers can transport the absolute temperature and the composition (so far only for two compositions with a constant viscosity and density). The property is then interpolated back to the regular grid points every time step. For more details see [AdvectMarker2D.m] and [TracerInterp.m].</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Thursday 12 June 2025 18:48">Thursday 12 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
