<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>2D · GeoModBox.jl</title><meta name="title" content="2D · GeoModBox.jl"/><meta property="og:title" content="2D · GeoModBox.jl"/><meta property="twitter:title" content="2D · GeoModBox.jl"/><meta name="description" content="Documentation for GeoModBox.jl."/><meta property="og:description" content="Documentation for GeoModBox.jl."/><meta property="twitter:description" content="Documentation for GeoModBox.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeoModBox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Governing Equation</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Solution</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../GESolution/">General</a></li><li><a class="tocitem" href="../Ini/">Initial Condition</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Heat Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../DiffMain/">General</a></li><li><a class="tocitem" href="../DiffOneD/">1D</a></li><li><a class="tocitem" href="../DiffTwoD/">2D</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Advection Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../AdvectMain/">General</a></li><li><a class="tocitem" href="../AdvOneD/">1D</a></li><li class="is-active"><a class="tocitem" href>2D</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Discretization-Schemes"><span>Discretization Schemes</span></a></li><li><a class="tocitem" href="#Upwind"><span>Upwind</span></a></li><li><a class="tocitem" href="#Staggered-Leapfrog"><span>Staggered Leapfrog</span></a></li><li><a class="tocitem" href="#Semi-lagragian"><span>Semi-lagragian</span></a></li><li><a class="tocitem" href="#Passive-tracers"><span>Passive tracers</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Momentum Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../MomentumMain/">General</a></li><li><a class="tocitem" href="../MomentumOneD/">1D</a></li><li><a class="tocitem" href="../MomentumTwoD/">2D</a></li></ul></li></ul></li><li><span class="tocitem">Exercises</span><ul><li><a class="tocitem" href="../Exercises/">General</a></li><li><a class="tocitem" href="../exercises/01_Euler_Advection/">01 - Euler Advection</a></li><li><a class="tocitem" href="../exercises/02_1D_Heat_explicit/">02 - 1D Heat Diffusion (explicit)</a></li><li><a class="tocitem" href="../exercises/03_1D_Heat_implicit/">03 - 1D Heat Diffusion (implicit)</a></li><li><a class="tocitem" href="../exercises/04_2D_Diffusion_Stationary/">04 - 2D Heat Diffusion (stationary)</a></li><li><a class="tocitem" href="../exercises/05_2D_Diffusion_TD_Plume/">05a - 2D Heat Diffusion (Plume)</a></li><li><a class="tocitem" href="../exercises/05_2D_Diffusion_TD_Sill/">05b - 2D Heat Diffusion (Sill)</a></li><li><a class="tocitem" href="../exercises/06_1D_Advection/">06 - 1D Advection</a></li><li><a class="tocitem" href="../exercises/07_2D_Energy_Equation/">07 - 2D Energy Conservation</a></li><li><a class="tocitem" href="../exercises/08_1D_Stokes/">08 - 1D Stokes</a></li><li><a class="tocitem" href="../exercises/09_2D_Falling_Block/">09 - 2D Falling Block (steady state)</a></li><li><a class="tocitem" href="../exercises/10_2D_Falling_Block_td/">10 - 2D Falling Block (time-dep)</a></li><li><a class="tocitem" href="../exercises/11_2D_Thermal_Convection/">11 - 2D Thermal Convection</a></li><li><a class="tocitem" href="../exercises/12_2D_Thermal_Convection_scaled/">12 - 2D Thermal Convection (scaled)</a></li><li><a class="tocitem" href="../exercises/13_Blankenbach_Benchmark/">13 - Blankenbach Benchmark</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../Examples/">General</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/OceanicGeotherm/">Oceanic Geotherm (1D)</a></li><li><a class="tocitem" href="../examples/ContinentalGeotherm/">Continental Geotherm (1D)</a></li><li><a class="tocitem" href="../examples/GaussianDiffusion1D/">Gaussian Diffusion (1D)</a></li><li><a class="tocitem" href="../examples/BackwardEuler_DC/">Backward Euler (2D)</a></li><li><a class="tocitem" href="../examples/ForwardEuler_DC/">Forward Euler (2D)</a></li><li><a class="tocitem" href="../examples/GaussianDiffusion2D/">Gaussian Diffusion (2D)</a></li><li><a class="tocitem" href="../examples/PoissonRestest/">Poisson Problem (2D)</a></li><li><a class="tocitem" href="../examples/PoissonVariablek/">Poisson Problem; variable k (2D)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Advection Equtaion</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/Advection2D/">Advection (2D)</a></li><li><a class="tocitem" href="../examples/AdvectionRestest2D/">Advection Resolution Test (2D)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Stokes Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/ChannelFlow1D/">Channel Flow (1D)</a></li><li><a class="tocitem" href="../examples/FallingBlockBenchmark/">Falling Block Benchmark</a></li><li><a class="tocitem" href="../examples/FallingBlockDC/">Falling Block</a></li><li><a class="tocitem" href="../examples/RTI/">Rayleigh Taylor Instability (RTI)</a></li><li><a class="tocitem" href="../examples/RTI_growth_rate/">RTI - Growth Rate</a></li><li><a class="tocitem" href="../examples/ViscousInclusion/">Viscous Inclusion</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Mixed Thermal Convection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/BottomHeatedConvection/">Bottom Heated</a></li><li><a class="tocitem" href="../examples/InternallyHeatedConvection/">Internally Heated</a></li><li><a class="tocitem" href="../examples/MixedHeatedConvection/">Mixed Heated</a></li></ul></li></ul></li><li><a class="tocitem" href="../listoffunctions/">List of functions</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Governing Equation</a></li><li><a class="is-disabled">Advection Equation</a></li><li class="is-active"><a href>2D</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>2D</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GeoSci-FFM/GeoModBox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/docs/src/man/AdvTwoD.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Advection-Equation-(2D)"><a class="docs-heading-anchor" href="#Advection-Equation-(2D)">Advection Equation (2D)</a><a id="Advection-Equation-(2D)-1"></a><a class="docs-heading-anchor-permalink" href="#Advection-Equation-(2D)" title="Permalink"></a></h1><p>In two dimensions (<span>$x$</span> and <span>$y$</span>), the advection equation for the temperature conservation equation, for example, is given as follows </p><p class="math-container">\[\begin{equation}
\frac{\partial{T}}{\partial{t}} = -v_x \left(\frac{\partial{T}}{\partial{x}}\right) - v_y \left(\frac{\partial{T}}{\partial{y}}\right),
\end{equation}\]</p><p>where <span>$T$</span> is the temperature [K], <span>$t$</span> is the time [s], and <span>$v_x$</span> and <span>$v_y$</span> are the velocities in the <span>$x$</span>- and <span>$y$</span>-direction, respectively. </p><p>The finite difference approximations of the different discretization schemes do not vary significantly from the 1D case. For more theoretical background, please refer to the <a href="../AdvOneD/">1D documentation</a>.</p><p>The following sections provide a brief overview of the available 2D discretization schemes.</p><h1 id="Discretization-Schemes"><a class="docs-heading-anchor" href="#Discretization-Schemes">Discretization Schemes</a><a id="Discretization-Schemes-1"></a><a class="docs-heading-anchor-permalink" href="#Discretization-Schemes" title="Permalink"></a></h1><h2 id="Upwind"><a class="docs-heading-anchor" href="#Upwind">Upwind</a><a id="Upwind-1"></a><a class="docs-heading-anchor-permalink" href="#Upwind" title="Permalink"></a></h2><p>In 2D, the advection equation can be discretized using the upwind scheme as:</p><p class="math-container">\[\begin{equation}
\frac{T_{i,j}^{n+1}-T_{i,j}^n}{\Delta t} = -v_{x;i,j}
\begin{cases}
\frac{T_{i,j}^{n}-T_{i-1,j}^n}{\Delta x} &amp;\text{if } v_{x;i,j} \gt 0 \\ \frac{T_{i+1,j}^{n}-T_{i,j}^n}{\Delta x} &amp;\text{if } v_{x;i,j} \lt &lt;0
\end{cases} 
-v_{y;i,j}
\begin{cases}
\frac{T_{i,j}^{n}-T_{i,j-1}^n}{\Delta y} &amp;\text{if } v_{y;i,j} &gt; 0 \\ 
\frac{T_{i,j+1}^{n}-T_{i,j}^n}{\Delta y} &amp;\text{if } v_{y;i,j}&lt;0
\end{cases},
\end{equation}\]</p><p>where <span>$T$</span> is the temperature, <span>$v$</span> the velocity, <span>$n$</span> is the current time step, <span>$\Delta t$</span> the time step increment, and <span>$i$</span>, <span>$j$</span> are the spatial indices in the <span>$x$</span>- and <span>$y$</span>-directions, respectively. For implementation details, see the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/AdvectionEquation/2Dsolvers.jl">source code</a>.</p><p>This method is stable and effective but introduces numerical diffusion if the Courant condition is not satisfied. It is also only first-order accurate in space.</p><h2 id="Staggered-Leapfrog"><a class="docs-heading-anchor" href="#Staggered-Leapfrog">Staggered Leapfrog</a><a id="Staggered-Leapfrog-1"></a><a class="docs-heading-anchor-permalink" href="#Staggered-Leapfrog" title="Permalink"></a></h2><p>The 2D staggered leapfrog discretization is given by:</p><p class="math-container">\[\begin{equation}
\frac{T_{i,j}^{n+1} - T_{i,j}^{n-1}}{2\Delta t} = 
-v_{x;i,j}\frac{T_{i+1,j}^{n} - T_{i-1,j}^{n}}{2\Delta x} 
-v_{y;i,j}\frac{T_{i,j+1}^{n} - T_{i,j-1}^{n}}{2\Delta y}.
\end{equation}\]</p><p>For implementation details, see the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/AdvectionEquation/2Dsolvers.jl">source code</a>.</p><h2 id="Semi-lagragian"><a class="docs-heading-anchor" href="#Semi-lagragian">Semi-lagragian</a><a id="Semi-lagragian-1"></a><a class="docs-heading-anchor-permalink" href="#Semi-lagragian" title="Permalink"></a></h2><p>In 2D, velocity can vary significantly in space and time. Therefore, a modified version of the 1D semi-Lagrangian scheme is used, employing an <em>iterative midpoint method</em> to determine the origin of the characteristic trajectory. The following steps are performed:</p><p><strong>1. Mid-point (half time step) origin</strong>  Estimate the intermediate position <span>$X&#39;$</span> at time <span>$t_{n+1/2}$</span> using the velocity at <span>$t_{n+1}$</span> at point <span>$(i,j)$</span>.</p><p><strong>2. Mid-point velocity</strong>  Compute the velocity at <span>$X&#39;$</span> using temporal averaging:</p><p class="math-container">\[\begin{equation}
v\left(t_{n+1/2},(i,j)\right) = \frac{v\left(t_{n+1},(i,j)\right) + v\left(t_{n},(i,j)\right)}{2}.
\end{equation}\]</p><p>The velocity at <span>$X&#39;$</span> can be interpolated linearly from the surrounding grid points.</p><p><strong>3. Actual origin point</strong> </p><p>Calculate the actual origin <span>$X(t)$</span> for the position <span>$x(t_{n+1},(i,j))$</span> using:</p><p class="math-container">\[\begin{equation}
X(t) = x\left(t+1,(i,j)\right) - \Delta{t}v\left(t_{n+1/2},X&#39;\right).
\end{equation}\]</p><p>This step is performed iteratively (e.g., five iterations or until convergence).</p><p><strong>4. Update temperature</strong>  Use cubic interpolation to determine the temperature at the origin <span>$X(t)$</span>, which defines the temperature at the final position <span>$x(t_{n+1},(i,j))$</span>.</p><p>This scheme assumes no heat sources during advection. It is free from numerical diffusion but introduces interpolation-based inaccuracies. For implementation details, see the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/AdvectionEquation/2Dsolvers.jl">source code</a>.   </p><h2 id="Passive-tracers"><a class="docs-heading-anchor" href="#Passive-tracers">Passive tracers</a><a id="Passive-tracers-1"></a><a class="docs-heading-anchor-permalink" href="#Passive-tracers" title="Permalink"></a></h2><p>Tracers are advected in 2D using fourth-oder Runge-Kutta method: </p><p class="math-container">\[\begin{equation}\begin{split}
x_p^{n+1} &amp; = x_p^n + \frac{1}{6}k_1 + \frac{1}{3}k_2 + \frac{1}{3}k_3 + \frac{1}{6}k_4, \\
y_p^{n+1} &amp; = y_p^n + \frac{1}{6}m_1 + \frac{1}{3}m_2 + \frac{1}{3}m_3 + \frac{1}{6}m_4,
\end{split}
\end{equation}\]</p><p>where:</p><p class="math-container">\[\begin{equation}
\begin{split}
k_1 &amp; = \Delta{t} \cdot v_x(t^n,(x_p^n,y_p^n)) \\
m_1 &amp; = \Delta{t} \cdot v_y(t^n,(x_p^n,y_p^n)) \\ \newline
k_2 &amp; = \Delta{t} \cdot v_x(t^n+\Delta{t}/2,(x_p^n+k_1/2,y_p^n+m_1/2)) \\
m_2 &amp; = \Delta{t} \cdot v_y(t^n+\Delta{t}/2,(x_p^n+k_1/2,y_p^n+m_1/2)) \\ \newline
k_3 &amp; = \Delta{t} \cdot v_x(t^n+\Delta{t}/2,(x_p^n+k_2/2,y_p^n+m_2/2)) \\
m_3 &amp; = \Delta{t} \cdot v_y(t^n+\Delta{t}/2,(x_p^n+k_2/2,y_p^n+m_2/2)) \\ \newline
k_4 &amp; = \Delta{t} \cdot v_x(t^n+\Delta{t},(x_p^n+k_3,y_p^n+m_3)) \\
m_4 &amp; = \Delta{t} \cdot v_y(t^n+\Delta{t},(y_p^n+k_3,y_p^n+m_3)) \\
\end{split}
\end{equation}\]</p><p>Per default, the tracers are advected by the velocity of the staggered velocity vertices. However, if required the velocity on the centroids or a combination of both is possible. The tracer velocity is calculated using a bilinear interpolation scheme. </p><p>The tracers can also be advected parallel by defining the maximum number of threads in the VScode julia extension settings (&quot;julia.NumThreads&quot;). </p><p>Tracers can carry different properties such as absolute temperature or phase identification number (ID). For temperature, interpolation between centroids and tracer positions is required. Note that this implementation currently does not support fully coupled temperature-momentum simulations.</p><p>Alternatively, phase IDs (linked to properties like constant density or viscosity) can be advected to simulate compositional heterogeneity. Property interpolation is performed at vertices or centroids depending on the required context (e.g., viscosity for the momentum equations).</p><p>Caution is required when interpolating properties between the grid and tracers, especially when those properties influence the governing equations (e.g., viscosity in momentum conservation).</p><p>Currently, no new tracers are inserted where needed, limiting the applicability of this approach for coupled temperature-momentum models.</p><p>For implementation details, please refer to the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/AdvectionEquation/2Dsolvers.jl">source code</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../AdvOneD/">« 1D</a><a class="docs-footer-nextpage" href="../MomentumMain/">General »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 9 October 2025 13:12">Thursday 9 October 2025</span>. Using Julia version 1.12.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
