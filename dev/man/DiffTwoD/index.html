<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>2D · GeoModBox.jl</title><meta name="title" content="2D · GeoModBox.jl"/><meta property="og:title" content="2D · GeoModBox.jl"/><meta property="twitter:title" content="2D · GeoModBox.jl"/><meta name="description" content="Documentation for GeoModBox.jl."/><meta property="og:description" content="Documentation for GeoModBox.jl."/><meta property="twitter:description" content="Documentation for GeoModBox.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeoModBox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Governing Equation</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Solution</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../GESolution/">General</a></li><li><a class="tocitem" href="../Ini/">Initial Condition</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Heat Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../DiffMain/">General</a></li><li><a class="tocitem" href="../DiffOneD/">1D</a></li><li class="is-active"><a class="tocitem" href>2D</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Discretization-and-Numerical-Schemes"><span>Discretization and Numerical Schemes</span></a></li><li><a class="tocitem" href="#Explicit-Scheme:-FTCS-(Forward-Time,-Centered-Space)"><span>Explicit Scheme: FTCS (Forward Time, Centered Space)</span></a></li><li><a class="tocitem" href="#Implicit-Scheme:-Backward-Euler-Method"><span>Implicit Scheme: Backward Euler Method</span></a></li><li><a class="tocitem" href="#Defect-Correction-Method"><span>Defect Correction Method</span></a></li><li><a class="tocitem" href="#Cranck-Nicolson-Approach-(CNA)"><span>Cranck-Nicolson Approach (CNA)</span></a></li><li><a class="tocitem" href="#Alternating-Direction-Implicit-(ADI)"><span>Alternating-Direction Implicit (ADI)</span></a></li><li><a class="tocitem" href="#Variable-Thermal-Parameters"><span>Variable Thermal Parameters</span></a></li><li><a class="tocitem" href="#Temperature-Field-Management"><span>Temperature Field Management</span></a></li><li class="toplevel"><a class="tocitem" href="#Steady-State-Solution"><span>Steady State Solution</span></a></li><li><a class="tocitem" href="#Poisson-Equation-(Constant-k)"><span>Poisson Equation (Constant <span>$k$</span>)</span></a></li><li><a class="tocitem" href="#Poisson-Equation-(variable-k)"><span>Poisson Equation (variable <span>$k$</span>)</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Advection Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../AdvectMain/">General</a></li><li><a class="tocitem" href="../AdvOneD/">1D</a></li><li><a class="tocitem" href="../AdvTwoD/">2D</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Momentum Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../MomentumMain/">General</a></li><li><a class="tocitem" href="../MomentumOneD/">1D</a></li><li><a class="tocitem" href="../MomentumTwoD/">2D</a></li></ul></li></ul></li><li><span class="tocitem">Exercises</span><ul><li><a class="tocitem" href="../Exercises/">General</a></li><li><a class="tocitem" href="../exercises/01_Euler_Advection/">01 - Euler Advection</a></li><li><a class="tocitem" href="../exercises/02_1D_Heat_explicit/">02 - 1D Heat Diffusion (explicit)</a></li><li><a class="tocitem" href="../exercises/03_1D_Heat_implicit/">03 - 1D Heat Diffusion (implicit)</a></li><li><a class="tocitem" href="../exercises/04_2D_Diffusion_Stationary/">04 - 2D Heat Diffusion (stationary)</a></li><li><a class="tocitem" href="../exercises/05_2D_Diffusion_TD_Plume/">05a - 2D Heat Diffusion (Plume)</a></li><li><a class="tocitem" href="../exercises/05_2D_Diffusion_TD_Sill/">05b - 2D Heat Diffusion (Sill)</a></li><li><a class="tocitem" href="../exercises/06_1D_Advection/">06 - 1D Advection</a></li><li><a class="tocitem" href="../exercises/07_2D_Energy_Equation/">07 - 2D Energy Conservation</a></li><li><a class="tocitem" href="../exercises/08_1D_Stokes/">08 - 1D Stokes</a></li><li><a class="tocitem" href="../exercises/09_2D_Falling_Block/">09 - 2D Falling Block (steady state)</a></li><li><a class="tocitem" href="../exercises/10_2D_Falling_Block_td/">10 - 2D Falling Block (time-dep)</a></li><li><a class="tocitem" href="../exercises/11_2D_Thermal_Convection/">11 - 2D Thermal Convection</a></li><li><a class="tocitem" href="../exercises/12_2D_Thermal_Convection_scaled/">12 - 2D Thermal Convection (scaled)</a></li><li><a class="tocitem" href="../exercises/13_Blankenbach_Benchmark/">13 - Blankenbach Benchmark</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../Examples/">General</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/OceanicGeotherm/">Oceanic Geotherm (1D)</a></li><li><a class="tocitem" href="../examples/ContinentalGeotherm/">Continental Geotherm (1D)</a></li><li><a class="tocitem" href="../examples/GaussianDiffusion1D/">Gaussian Diffusion (1D)</a></li><li><a class="tocitem" href="../examples/BackwardEuler_DC/">Backward Euler (2D)</a></li><li><a class="tocitem" href="../examples/ForwardEuler_DC/">Forward Euler (2D)</a></li><li><a class="tocitem" href="../examples/GaussianDiffusion2D/">Gaussian Diffusion (2D)</a></li><li><a class="tocitem" href="../examples/PoissonRestest/">Poisson Problem (2D)</a></li><li><a class="tocitem" href="../examples/PoissonVariablek/">Poisson Problem; variable k (2D)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Advection Equtaion</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/Advection2D/">Advection (2D)</a></li><li><a class="tocitem" href="../examples/AdvectionRestest2D/">Advection Resolution Test (2D)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Stokes Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/ChannelFlow1D/">Channel Flow (1D)</a></li><li><a class="tocitem" href="../examples/FallingBlockBenchmark/">Falling Block Benchmark</a></li><li><a class="tocitem" href="../examples/FallingBlockDC/">Falling Block</a></li><li><a class="tocitem" href="../examples/RTI/">Rayleigh Taylor Instability (RTI)</a></li><li><a class="tocitem" href="../examples/RTI_growth_rate/">RTI - Growth Rate</a></li><li><a class="tocitem" href="../examples/ViscousInclusion/">Viscous Inclusion</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Mixed Thermal Convection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/BottomHeatedConvection/">Bottom Heated</a></li><li><a class="tocitem" href="../examples/InternallyHeatedConvection/">Internally Heated</a></li><li><a class="tocitem" href="../examples/MixedHeatedConvection/">Mixed Heated</a></li></ul></li></ul></li><li><a class="tocitem" href="../listoffunctions/">List of functions</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Governing Equation</a></li><li><a class="is-disabled">Heat Diffusion Equation</a></li><li class="is-active"><a href>2D</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>2D</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GeoSci-FFM/GeoModBox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/docs/src/man/DiffTwoD.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Temperature-Equation-(2D)"><a class="docs-heading-anchor" href="#Temperature-Equation-(2D)">Temperature Equation (2D)</a><a id="Temperature-Equation-(2D)-1"></a><a class="docs-heading-anchor-permalink" href="#Temperature-Equation-(2D)" title="Permalink"></a></h1><p>In two spatial dimensions (<span>$x$</span> and <span>$y$</span>), the diffusive part of the temperature equation, assuming only radiogenic heat production, is given by:</p><p class="math-container">\[\begin{equation}
\rho c_p \frac{\partial T}{\partial t} = -\frac{\partial q_x}{\partial x} -\frac{\partial q_y}{\partial y} + \rho H, 
\end{equation}\]</p><p>where  <span>$\rho$</span> is the density [kg/m³], <span>$c_p$</span> is the specific heat capacity [J/(kg·K)], <span>$T$</span> is the temperature [K], <span>$t$</span> is time [s], <span>$q_x$</span> and <span>$q_y$</span> are the heat flux components in the <span>$x$</span> and <span>$y$</span> directions [W/m²], and <span>$H$</span> is the volumetric heat production rate per unit mass [W/kg].</p><p>By applying Fourier’s law and allowing for spatially variable thermal conductivity <span>$k$</span>, the equation becomes:</p><p class="math-container">\[\begin{equation}
\rho c_p \frac{\partial T}{\partial t} = \frac{\partial}{\partial x} k \frac{\partial T}{\partial x} + \frac{\partial}{\partial y} k \frac{\partial T}{\partial y} + \rho H.
\end{equation}\]</p><p>If thermal parameters are assumed constant, this simplifies to:</p><p class="math-container">\[\begin{equation}
\frac{\partial T}{\partial t} = \kappa \left(\frac{\partial^2 T}{\partial x^2} + \frac{\partial^2 T}{\partial y^2}\right) + \frac{Q}{\rho c_p},
\end{equation}\]</p><p>where  <span>$\kappa = \frac{k}{\rho c_p}$</span> is the thermal diffusivity [m²/s] and <span>$Q = \rho H$</span> is the volumetric heat production rate [W/m³].</p><h1 id="Discretization-and-Numerical-Schemes"><a class="docs-heading-anchor" href="#Discretization-and-Numerical-Schemes">Discretization and Numerical Schemes</a><a id="Discretization-and-Numerical-Schemes-1"></a><a class="docs-heading-anchor-permalink" href="#Discretization-and-Numerical-Schemes" title="Permalink"></a></h1><p>To numerically solve equation (3), the spatial domain must be discretized and the relevant thermal parameters assigned to the appropriate computational nodes.</p><p><img src="../../assets/2D_Diffusion_Grid.jpg" alt="2DDiffusionGrid"/></p><p><strong>Figure 1. 2D Discretization.</strong> <em>Conservative finite difference grid</em> for solving the 2D diffusive temperature equation. Temperature values are defined at the <em>centroids</em> (red circles), while heat fluxes are computed at the <em>vertices</em> (horizontal flux: blue crosses; vertical flux: green squares). <em>Ghost nodes</em> (grey circles) are used to implement <em>Dirichlet</em> and <em>Neumann</em> boundary conditions.</p><p>A detailed implementation of various numerical schemes is provided in the example script <a href="../examples/GaussianDiffusion2D/">Gaussian_Diffusion.jl</a>. This example demonstrates the application of several methods for solving the diffusive part of the 2D temperature equation:</p><ul><li><strong>Explicit scheme</strong></li><li><strong>Fully implicit scheme</strong></li><li><strong>Crank–Nicolson approach</strong></li><li><strong>Alternating Direction Implicit (ADI) method</strong></li><li><strong>Defect correction method</strong></li></ul><p>The numerical results are compared with the analytical solution of a Gaussian temperature distribution to assess accuracy and performance.</p><p>Each numerical scheme is briefly outlined in the following sections. For implementation details and derivations in one dimension, refer to the <a href="../DiffOneD/">1D solver documentation</a>.</p><h2 id="Explicit-Scheme:-FTCS-(Forward-Time,-Centered-Space)"><a class="docs-heading-anchor" href="#Explicit-Scheme:-FTCS-(Forward-Time,-Centered-Space)">Explicit Scheme: FTCS (Forward Time, Centered Space)</a><a id="Explicit-Scheme:-FTCS-(Forward-Time,-Centered-Space)-1"></a><a class="docs-heading-anchor-permalink" href="#Explicit-Scheme:-FTCS-(Forward-Time,-Centered-Space)" title="Permalink"></a></h2><p>For an explicit finite difference discretization, the numerical stability criterion (heat diffusion condition) is given by:</p><p class="math-container">\[\begin{equation}
\Delta{t} &lt; \frac{1}{2 \kappa \left(\frac{1}{\Delta{x^2}}+\frac{1}{\Delta{y^2}}\right)}
\end{equation}\]</p><p>where <span>$\Delta x$</span> and <span>$\Delta y$</span> denote the spatial grid spacing in the <span>$x$</span> and <span>$y$</span> directions, respectively. This condition must be satisfied to ensure numerical stability of the explicit scheme.</p><p>In two dimensions, the partial derivatives in equation (3) can be approximated using an explicit FTCS (Forward Time, Centered Space) finite difference scheme:</p><p class="math-container">\[\begin{equation}
\frac{T_{i,j}^{n+1} - T_{i,j}^{n} }{\Delta t} = \kappa \left( \frac{T_{i-1,j}^{n} - 2T_{i,j}^{n} + T_{i+1,j}^{n}}{\Delta{x}^2} + \frac{T_{i,j-1}^{n} - 2T_{i,j}^{n} + T_{i,j+1}^{n}}{\Delta{z^2}} \right) + \frac{Q_{i,j}^n}{\rho c_p}. 
\end{equation}\]</p><p>Here, <span>$i$</span> and <span>$j$</span> are the horizontal and vertical grid indices, respectively, <span>$n$</span> is the time step index, <span>$\Delta t $ is the time step size, and $\Delta x$</span>, <span>$\Delta y$</span> are the grid spacings in the horizontal and vertical directions.</p><p>Rearranging this equation to solve for the temperature at the next time step yields:</p><p class="math-container">\[\begin{equation}
T_{i,j}^{n+1} = T_{i,j}^{n} + a\left(T_{i-1,j}^{n} - 2T_{i,j}^{n} + T_{i+1,j}^{n}\right) + b\left(T_{i,j-1}^{n} - 2T_{i,j}^{n} + T_{i,j+1}^{n}\right) + \frac{Q_{i,j}^n \Delta{t}}{\rho c_p}, 
\end{equation}\]</p><p>where </p><p class="math-container">\[\begin{equation}
a = \frac{\kappa \Delta{t}}{\Delta{x^2}}, \quad 
b = \frac{\kappa \Delta{t}}{\Delta{y^2}}.
\end{equation}\]</p><p>For implementation details, see the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/HeatEquation/2Dsolvers.jl">source code</a>.</p><h3 id="Boundary-Conditions"><a class="docs-heading-anchor" href="#Boundary-Conditions">Boundary Conditions</a><a id="Boundary-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-Conditions" title="Permalink"></a></h3><p>To correctly impose boundary conditions, ghost nodes are used adjacent to the domain boundaries.</p><p><strong>Dirichlet Boundary Conditions</strong></p><p><em>Dirichlet</em> conditions impose a fixed temperature value along the boundary. The ghost node temperatures are calculated as:</p><p><strong>West boundary</strong></p><p class="math-container">\[\begin{equation}
T_{G,W} = 2T_{BC,W} - T_{1,:}
\end{equation}\]</p><p><strong>East boundary</strong></p><p class="math-container">\[\begin{equation}
T_{G,E} = 2T_{BC,E} - T_{ncx,:}
\end{equation}\]</p><p><strong>South boundary</strong></p><p class="math-container">\[\begin{equation}
T_{G,S} = 2T_{BC,S} - T_{:,1}
\end{equation}\]</p><p><strong>North boundary</strong></p><p class="math-container">\[\begin{equation}
T_{G,N} = 2T_{BC,N} - T_{:,ncy}
\end{equation}\]</p><p>Here, <span>$T_{BC,W}$</span>, <span>$T_{BC,E}$</span>, <span>$T_{BC,S}$</span>, and <span>$T_{BC,N}$</span> are the prescribed boundary temperatures on the west, east, south, and north boundaries, respectively. The notation <span>$T_{i,:}$</span> and <span>$T_{:,j}$</span> refers to slices along rows and columns.</p><p><strong>Neumann Boundary Conditions</strong></p><p><em>Neumann</em> conditions impose a prescribed gradient (e.g., heat flux) across the boundary. Ghost node temperatures are computed as:</p><p><strong>West boundary</strong></p><p class="math-container">\[\begin{equation}
T_{G,W} = T_{1,:} - c_{W} \Delta{x},
\end{equation}\]</p><p><strong>East boundary</strong></p><p class="math-container">\[\begin{equation}
T_{G,E} = T_{ncx,:} + c_{E} \Delta{x},
\end{equation}\]</p><p><strong>South boundary</strong></p><p class="math-container">\[\begin{equation}
T_{G,S} = T_{:,1} - c_{S} \Delta{y},
\end{equation}\]</p><p><strong>North boundary</strong></p><p class="math-container">\[\begin{equation}
T_{G,N} = T_{:,ncy} + c_{N} \Delta{y},
\end{equation}\]</p><p>where </p><p class="math-container">\[\begin{equation}
\left. c_{W} = \frac{\partial{T}}{\partial{x}} \right\vert_{W}, \left. c_{E} = \frac{\partial{T}}{\partial{x}} \right\vert_{E}, 
\left. c_{S} = \frac{\partial{T}}{\partial{y}} \right\vert_{S},
\left. c_{N} = \frac{\partial{T}}{\partial{y}} \right\vert_{N},
\end{equation}\]</p><p>are the specified temperature gradients (or fluxes) at each boundary.</p><p>Once the ghost node temperatures are defined according to the chosen boundary conditions, equation (6) can be used to update the temperature at the <em>centroids</em> for the next time step.</p><h2 id="Implicit-Scheme:-Backward-Euler-Method"><a class="docs-heading-anchor" href="#Implicit-Scheme:-Backward-Euler-Method">Implicit Scheme: Backward Euler Method</a><a id="Implicit-Scheme:-Backward-Euler-Method-1"></a><a class="docs-heading-anchor-permalink" href="#Implicit-Scheme:-Backward-Euler-Method" title="Permalink"></a></h2><p>In two dimensions, the temperature equation can be discretized using the implicit (Backward Euler) method as:</p><p class="math-container">\[\begin{equation}
\frac{T_{i,j}^{n+1}-T_{i,j}^n}{\Delta t} = 
\kappa \left( 
    \frac{T_{i-1,j}^{n+1}-2T_{i,j}^{n+1}+T_{i+1,j}^{n+1}}{\Delta x^2} + 
    \frac{T_{i,j-1}^{n+1}-2T_{i,j}^{n+1}+T_{i,j+1}^{n+1}}{\Delta y^2} 
    \right) + 
\frac{Q_{i}^n}{\rho c_p},
\end{equation}\]</p><p>Here, <span>$n$</span> and <span>$n+1$</span> denote the current and next time steps, <span>$\Delta t$</span> is the time step size, <span>$\Delta x$</span> and <span>$\Delta y$</span> are the grid spacings, and <span>$i$</span>, <span>$j$</span> are the horizontal and vertical indices, respectively.</p><p>Rewriting this equation to separate known and unknown terms results in a linear system of equations of the form:</p><p class="math-container">\[\begin{equation}
-b T_{i,j-1}^{n+1} - a T_{i-1,j}^{n+1} + 
\left(2a + 2b + c \right) T_{i,j}^{n+1} - 
a T_{i+1,j}^{n+1} - b T_{i,j+1}^{n+1} = 
c T_{i,j}^n + \frac{Q_{i,j}^n}{\rho c_p},
\end{equation}\]</p><p>where </p><p class="math-container">\[\begin{equation}
a = \frac{\kappa}{\Delta{x^2}}, \quad
b = \frac{\kappa}{\Delta{y^2}}, \quad 
c = \frac{1}{\Delta{t}}.
\end{equation}\]</p><h3 id="Boundary-Conditions-2"><a class="docs-heading-anchor" href="#Boundary-Conditions-2">Boundary Conditions</a><a class="docs-heading-anchor-permalink" href="#Boundary-Conditions-2" title="Permalink"></a></h3><p>Boundary conditions are imposed via ghost nodes, as previously described (see equations (7)–(14)). However, to ensure a symmetric coefficient matrix in the resulting linear system, both the coefficients and the right-hand side for centroids adjacent to the boundaries must be modified accordingly.</p><p><strong>Dirichlet Boundary Conditions</strong></p><p><strong>West boundary</strong></p><p class="math-container">\[\begin{equation}
-b T_{1,j-1}^{n+1} + \left(3 a + 2b + c\right) T_{1,j}^{n+1} - a T_{2,j}^{n+1}  - b T_{1,j+1}^{n+1} = c T_{1,j}^{n} + 2 a T_{BC,W} + \frac{Q_{i,j}}{\rho c_p}
\end{equation}\]</p><p><strong>East boundary</strong></p><p class="math-container">\[\begin{equation}
-b T_{ncx,j-1}^{n+1} - aT_{ncx-1,j}^{n+1} + \left(3 a + 2b + c\right) T_{ncx,j}^{n+1} - b T_{ncx,j+1}^{n+1} = 
c T_{ncx,j}^{n} + 2 a T_{BC,E} + \frac{Q_{i,j}}{\rho c_p}
\end{equation}\]</p><p><strong>South boundary</strong></p><p class="math-container">\[\begin{equation}
-a T_{i-1,1}^{n+1} + \left(2a + 3b + c\right) T_{i,1}^{n+1} - a T_{i+1,1}^{n+1} - bT_{i,2}^{n+1} = 
c T_{i,1}^{n} + 2 b T_{BC,S} + \frac{Q_{i,j}}{\rho c_p}
\end{equation}\]</p><p><strong>North boundary</strong></p><p class="math-container">\[\begin{equation}
-b T_{i,ncy}^{n+1} - aT_{i-1,ncy}^{n+1} + \left(2a + 3b + c\right) T_{i,ncy}^{n+1} - a T_{i+1,ncy}^{n+1} = 
c T_{i,ncy}^{n} + 2 b T_{BC,N} + \frac{Q_{i,j}}{\rho c_p}
\end{equation}\]</p><p><strong>Neumann Boundary Conditions</strong></p><p><strong>West boundary</strong></p><p class="math-container">\[\begin{equation}
-b T_{1,j-1}^{n+1} + \left(a + 2b + c\right) T_{1,j}^{n+1} - a T_{2,j}^{n+1}  - b T_{1,j+1}^{n+1} = 
c T_{1,j}^{n} - a c_W \Delta{x} + \frac{Q_{i,j}}{\rho c_p}
\end{equation}\]</p><p><strong>East boundary</strong></p><p class="math-container">\[\begin{equation}
-b T_{ncx,j-1}^{n+1} - aT_{ncx-1,j}^{n+1} + \left(a + 2b + c\right) T_{ncx,j}^{n+1} - b T_{ncx,j+1}^{n+1} = 
c T_{ncx,j}^{n} + a c_E \Delta{x} + \frac{Q_{i,j}}{\rho c_p}
\end{equation}\]</p><p><strong>South boundary</strong></p><p class="math-container">\[\begin{equation}
-a T_{i-1,1}^{n+1} + \left(2a + b + c\right) T_{i,1}^{n+1} - a T_{i+1,1}^{n+1} - bT_{i,2}^{n+1} = 
c T_{i,1}^{n} - b c_S \Delta{y} + \frac{Q_{i,j}}{\rho c_p}
\end{equation}\]</p><p><strong>North boundary</strong></p><p class="math-container">\[\begin{equation}
-b T_{i,ncy}^{n+1} - aT_{i-1,ncy}^{n+1} + \left(2a + b + c\right) T_{i,ncy}^{n+1} - a T_{i+1,ncy}^{n+1} = 
c T_{i,ncy}^{n} + b c_N \Delta{y} + \frac{Q_{i,j}}{\rho c_p}
\end{equation}\]</p><p>These boundary-specific formulations ensure symmetry in the coefficient matrix and proper enforcement of Dirichlet and Neumann conditions within the implicit time-stepping scheme.</p><h2 id="Defect-Correction-Method"><a class="docs-heading-anchor" href="#Defect-Correction-Method">Defect Correction Method</a><a id="Defect-Correction-Method-1"></a><a class="docs-heading-anchor-permalink" href="#Defect-Correction-Method" title="Permalink"></a></h2><p>The defect correction method reformulates the diffusive part of the temperature equation by introducing a residual term <span>$R$</span>, representing the defect (or error) in the discretized equation. This can be expressed as:</p><p class="math-container">\[\begin{equation}
\frac{\partial{T}}{\partial{t}} - \kappa \left( \frac{\partial^2{T}}{\partial{x}^2} + \frac{\partial^2{T}}{\partial{y}^2} \right) - \frac{Q_{i,j}^n}{\rho c_p} = R.
\end{equation}\]</p><p>Discretizing the equation in space and time using implicit finite differences yields:</p><p class="math-container">\[\begin{equation}
\frac{T_{i,j}^{n+1}-T_{i,j}^{n}}{\Delta{t}} - \kappa 
\left( \frac{T_{i-1,j}^{n+1} - 2 T_{i,j}^{n+1} + T_{i+1,j}^{n+1}}{\Delta{x}^2} + \frac{T_{i,j-1}^{n+1} - 2 T_{i,j}^{n+1} + T_{i,j+1}^{n+1}}{\Delta{y}^2}  
\right) - \frac{Q_{i,j}^n}{\rho c_p} = R.
\end{equation}\]</p><p>Rewriting this in a matrix-compatible form leads to:</p><p class="math-container">\[\begin{equation}
-b T_{i,j-1}^{n+1} - a T_{i-1,j}^{n+1} + 
\left(2a + 2b + c \right) T_{i,j}^{n+1} - 
a T_{i+1,j}^{n+1} - b T_{i,j+1}^{n+1} - 
c T_{i,j}^n - \frac{Q_{i,j}^n}{\rho c_p} = 
R,
\end{equation}\]</p><p>where the coefficients are defined as:</p><p class="math-container">\[\begin{equation}
a = \frac{\kappa}{\Delta{x}^2},\quad  
b = \frac{\kappa}{\Delta{y}^2}, \textrm{and} \quad c = \frac{1}{\Delta{t}}, 
\end{equation}\]</p><p>In this formulation, the defect <span>$R$</span> quantifies the deviation from the true solution and can be used iteratively to improve accuracy through successive correction steps.</p><p>For more background on the defect correction approach, see the <a href="../DiffOneD/">1-D example</a>. For implementation details, refer to the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/HeatEquation/2Dsolvers.jl">source code</a>.</p><h2 id="Cranck-Nicolson-Approach-(CNA)"><a class="docs-heading-anchor" href="#Cranck-Nicolson-Approach-(CNA)">Cranck-Nicolson Approach (CNA)</a><a id="Cranck-Nicolson-Approach-(CNA)-1"></a><a class="docs-heading-anchor-permalink" href="#Cranck-Nicolson-Approach-(CNA)" title="Permalink"></a></h2><p>In 2-D, the diffusive part of the heat equation (Equation 3) using the Crank–Nicolson method is written as:</p><p class="math-container">\[\begin{equation}\begin{gather*}
&amp; \frac{T_{i,j}^{n+1} - T_{i,j}^{n}}{\Delta t} = \\ &amp;
\frac{\kappa}{2}\frac{(T_{i-1,j}^{n+1}-2T_{i,j}^{n+1}+T_{i+1,j}^{n+1})+(T_{i-1,j}^{n}-2T_{i,j}^{n}+T_{i+1,j}^{n})}{\Delta x^2} + \\ &amp;
\frac{\kappa}{2}\frac{(T_{i,j-1}^{n+1}-2T_{i,j}^{n+1}+T_{i,j+1}^{n+1})+(T_{i,j-1}^{n}-2T_{i,j}^{n}+T_{i,j+1}^{n})}{\Delta y^2} + \frac{Q_{i,j}^n}{\rho c_p}
\end{gather*}\end{equation}\]</p><p>Rearranging into a form that separates known and unknown variables gives the linear system:</p><p class="math-container">\[\begin{equation}\begin{gather*}
&amp; -b T_{i,j-1}^{n+1} -aT_{i-1,j}^{n+1}+\left(2a + 2b + c\right)T_{i,j}^{n+1} -aT_{i+1,j}^{n+1} -b T_{i,j+1}^{n+1} = \\ &amp;b T_{i,j-1}^{n} +aT_{i-1,j}^{n}-\left(2a + 2b - c\right)T_{i,j}^{n} +aT_{i+1,j}^{n} +b T_{i,j+1}^{n} + \frac{Q_{i,j}^n}{\rho c_p}
\end{gather*}\end{equation}\]</p><p>where the coefficients are defined as:</p><p class="math-container">\[\begin{equation}
a = \frac{\kappa}{\Delta x^2}, \quad 
b = \frac{\kappa}{\Delta y^2}, \quad 
c = \frac{1}{\Delta t}
\end{equation}\]</p><p>As with the implicit method, the boundary-adjacent centroids require modified coefficients to accommodate boundary conditions and maintain symmetry in the coefficient matrix.</p><p><strong>Dirichlet Boundary Conditions</strong></p><p><strong>West boundary</strong></p><p class="math-container">\[\begin{equation}\begin{gather*}
&amp; -b T_{1,j-1}^{n+1} +
\left(3a + 2b + c \right) T_{1,j}^{n+1} 
-a T_{2,j}^{n+1} - b T_{1,j+1}^{n+1} = \\ &amp;
b T_{1,j-1}^{n} - \left( 3a + 2b - c \right) T_{1,j}^{n} + a T_{2,j}^{n} + b T_{1,j+1}^{n} + 4 a T_{BC,W} + \frac{Q_{i,j}^n}{\rho c_p},
\end{gather*}\end{equation}\]</p><p><strong>East boundary</strong></p><p class="math-container">\[\begin{equation}\begin{gather*}
&amp; -b T_{ncx,j-1}^{n+1} - a T_{ncx-1,j}^{n+1} +
\left(3a + 2b + c \right) T_{ncx,j}^{n+1} 
-b T_{ncx,j+1}^{n+1} = \\ &amp; 
b T_{ncx,j-1}^{n} + a T_{ncx-1,j}^{n} -
\left( 3a + 2b - c \right) T_{ncx,j}^{n} + b T_{ncx,j+1}^{n} + 4 a T_{BC,E} + \frac{Q_{i,j}^n}{\rho c_p},
\end{gather*}\end{equation}\]</p><p><strong>South boundary</strong></p><p class="math-container">\[\begin{equation}\begin{gather*}
&amp; -a T_{i-1,1}^{n+1} +
\left(2a + 3b + c \right) T_{i,1}^{n+1} - a T_{i+1,1}^{n+1} - b T_{i,2}^{n+1} = \\ &amp; 
a T_{i-1,1}^{n} - \left( 2a + 3b - c \right) T_{i,1}^{n} + a T_{i+1,1}^{n} + b T_{i,2}^{n} + 4 b T_{BC,S} + \frac{Q_{i,j}^n}{\rho c_p},
\end{gather*}\end{equation}\]</p><p><strong>North boundary</strong></p><p class="math-container">\[\begin{equation}\begin{gather*}
&amp; -b T_{i,ncy-1}^{n+1} + a T_{i-1,ncy}^{n+1} + \left(2a + 3b + c \right) T_{i,ncy}^{n+1} - a T_{i+1,ncy}^{n+1} = \\ &amp;
b T_{i,ncy-1}^{n} + a T_{i-1,ncy}^{n} - \left( 2a + 3b - c \right) T_{i,ncy}^{n} + a T_{i+1,ncy}^{n} + 4 b T_{BC,N} + \frac{Q_{i,j}^n}{\rho c_p}.
\end{gather*}\end{equation}\]</p><p><strong>Neumann Boundary Conditions</strong></p><p><strong>West boundary</strong></p><p class="math-container">\[\begin{equation}\begin{gather*}
&amp; -b T_{1,j-1}^{n+1} + \left(a + 2b + c \right) T_{1,j}^{n+1} - a T_{2,j}^{n+1} - b T_{1,j+1}^{n+1} = \\ &amp;
b T_{1,j-1}^{n} - \left( a + 2b - c \right) T_{1,j}^{n} + a T_{2,j}^{n} + b T_{1,j+1}^{n} - 2 a c_W \Delta{x} + \frac{Q_{i,j}^n}{\rho c_p},
\end{gather*}\end{equation}\]</p><p><strong>East boundary</strong></p><p class="math-container">\[\begin{equation}\begin{gather*}
&amp; -b T_{ncx,j-1}^{n+1} - a T_{ncx-1,j}^{n+1} + \left(a + 2b + c \right) T_{ncx,j}^{n+1} - b T_{ncx,j+1}^{n+1} = \\ &amp;
b T_{ncx,j-1}^{n} + a T_{ncx-1,j}^{n} - \left( a + 2b - c \right) T_{ncx,j}^{n} + b T_{ncx,j+1}^{n} + 2 a c_E \Delta{x} + \frac{Q_{i,j}^n}{\rho c_p},
\end{gather*}\end{equation}\]</p><p><strong>South boundary</strong></p><p class="math-container">\[\begin{equation}\begin{gather*}
&amp; -a T_{i-1,1}^{n+1} + \left(2a + b + c \right) T_{i,1}^{n+1} - a T_{i+1,1}^{n+1} - b T_{i,2}^{n+1} = \\ &amp;
a T_{i-1,1}^{n} - \left( 2a + b - c \right) T_{i,1}^{n} + a T_{i+1,1}^{n} + b T_{i,2}^{n} - 2 b c_S \Delta{y} + \frac{Q_{i,j}^n}{\rho c_p},
\end{gather*}\end{equation}\]</p><p><strong>North boundary</strong></p><p class="math-container">\[\begin{equation}\begin{gather*}
&amp; -b T_{i,ncy-1}^{n+1} + a T_{i-1,ncy}^{n+1} + \left(2a + b + c \right) T_{i,ncy}^{n+1} - a T_{i+1,ncy}^{n+1} = \\ &amp;
b T_{i,ncy-1}^{n} + a T_{i-1,ncy}^{n} - \left( 2a + b - c \right) T_{i,ncy}^{n} + a T_{i+1,ncy}^{n} + 2 b c_N \Delta{y} + \frac{Q_{i,j}^n}{\rho c_p}.
\end{gather*}\end{equation}\]</p><p>For implementation details, refer to the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/HeatEquation/2Dsolvers.jl">source code</a>.</p><h2 id="Alternating-Direction-Implicit-(ADI)"><a class="docs-heading-anchor" href="#Alternating-Direction-Implicit-(ADI)">Alternating-Direction Implicit (ADI)</a><a id="Alternating-Direction-Implicit-(ADI)-1"></a><a class="docs-heading-anchor-permalink" href="#Alternating-Direction-Implicit-(ADI)" title="Permalink"></a></h2><p>In 2-D, the diffusive part of the heat equation (Equation 3) is discretized using the Alternating-Direction Implicit (ADI) method by splitting the time step into two fractional steps. The resulting system for each half-step is:</p><h3 id="First-half-step-(implicit-in-y,-explicit-in-x):"><a class="docs-heading-anchor" href="#First-half-step-(implicit-in-y,-explicit-in-x):">First half-step (implicit in <span>$y$</span>, explicit in <span>$x$</span>):</a><a id="First-half-step-(implicit-in-y,-explicit-in-x):-1"></a><a class="docs-heading-anchor-permalink" href="#First-half-step-(implicit-in-y,-explicit-in-x):" title="Permalink"></a></h3><p class="math-container">\[\begin{equation}
\frac{T_{i,j}^{n+1/2}-T_{i,j}^n}{\Delta t/2} = 
\kappa 
    \left( 
    \frac{T_{i-1,j}^n-2T_{i,j}^n+T_{i+1,j}^n}{\Delta x^2} +
    \frac{T_{i,j-1}^{n+1/2}-2T_{i,j}^{n+1/2}+T_{i,j+1}^{n+1/2}}{\Delta y^2}
    \right) + \frac{Q_{i,j}^n}{\rho c_p}
\end{equation}\]</p><h3 id="Second-half-step-(implicit-in-x,-explicit-in-y):"><a class="docs-heading-anchor" href="#Second-half-step-(implicit-in-x,-explicit-in-y):">Second half-step (implicit in <span>$x$</span>, explicit in <span>$y$</span>):</a><a id="Second-half-step-(implicit-in-x,-explicit-in-y):-1"></a><a class="docs-heading-anchor-permalink" href="#Second-half-step-(implicit-in-x,-explicit-in-y):" title="Permalink"></a></h3><p class="math-container">\[\begin{equation}
\frac{T_{i,j}^{n+1}-T_{i,j}^{n+1/2}}{\Delta t/2} = 
\kappa 
    \left( 
    \frac{T_{i-1,j}^{n+1}-2T_{i,j}^{n+1}+T_{i+1,j}^{n+1}}{\Delta x^2} + 
    \frac{T_{i,j-1}^{n+1/2}-2T_{i,j}^{n+1/2}+T_{i,j+1}^{n+1/2}}{\Delta y^2}
    \right) + \frac{Q_{i,j}^n}{\rho c_p}
\end{equation}\]</p><p>Each fractional step results in a tridiagonal linear system, alternating between the <span>$x$</span>- and <span>$y$</span>-directions. This decomposition improves computational efficiency while retaining the stability benefits of implicit schemes.</p><p>As in the Crank–Nicolson approach, the coefficients and right-hand side vectors of these systems must be adjusted appropriately based on the prescribed boundary conditions (Dirichlet or Neumann). See the <em>CNA</em> section for examples of boundary treatment.</p><p>For implementation details, refer to the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/HeatEquation/2Dsolvers.jl">source code</a>.</p><h2 id="Variable-Thermal-Parameters"><a class="docs-heading-anchor" href="#Variable-Thermal-Parameters">Variable Thermal Parameters</a><a id="Variable-Thermal-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Variable-Thermal-Parameters" title="Permalink"></a></h2><blockquote><p><strong>Note:</strong> Variable thermal parameters are currently implemented for the 1-D time-dependent and 2-D steady-state cases. The 2-D defect correction method also supports time-dependent problems with variable parameters. These capabilities will be extended in future updates.</p></blockquote><p>The solution is the same as for constant thermal parameter, except that the coefficients of the matrix vary. </p><p>The residual <span>$R$</span> is then calculated as </p><p class="math-container">\[\begin{equation}
\rho c_p\frac{\partial{T}}{\partial{t}} + \frac{\partial{q_x}}{\partial{x}} + \frac{\partial{q_y}}{\partial{y}} - \rho H = R,
\end{equation}\]</p><p>where <span>$q_x$</span> and <span>$q_y$</span> are the horizontal and vertical heat fluxes, respectively, and are defined as</p><p class="math-container">\[\begin{equation}\begin{split}
q_x &amp; = - k_x\frac{\partial{T}}{\partial{x}} \\
q_y &amp; = - k_y\frac{\partial{T}}{\partial{y}},
\end{split}\end{equation}\]</p><p>where <span>$k_x$</span> and <span>$k_y$</span> are the horizontal and vertical thermal conductivities. </p><p>Discretizing the equation in space and time using implicit finite differences yields: </p><p class="math-container">\[\begin{equation}
\rho_{i,j} c_{p,(i,j)}\left(\frac{T_{i,j}^{n+1} - T_{i,j}^{n}}{\Delta{t}}\right) 
+\frac{q_{x,(i+1,j)} - q_{x,(i,j)}}{\Delta{x}} 
+\frac{q_{y,(i,j+1)} - q_{y,(i,j)}}{\Delta{y}} 
-\rho_{i,j} H_{i,j} = R_{i,j}, 
\end{equation}\]</p><p>where <span>$\Delta{x}$</span> and <span>$\Delta{y}$</span> are the horizontal and vertical grid resolution, respectively, <span>$\Delta{t}$</span> is the time step length and <span>$i$</span> and <span>$j$</span> the horizontal and vertical indices, respectively. </p><p>By applying Fourier&#39;s law the equation results in:</p><p class="math-container">\[\begin{equation}
\rho_{i,j} c_{p,(i,j)}\left(\frac{T_{i,j}^{n+1} - T_{i,j}^{n}}{\Delta{t}}\right) 
+\left(
\frac{-k_{x,(i+1,j)}\frac{T_{i+1,j}^{n+1}-T_{i,j}^{n+1}}{\Delta{x}} 
+k_{x,(i,j)}\frac{T_{i,j}^{n+1}-T_{i-1,j}^{n+1}}{\Delta{x}}}
{\Delta{x}}
\right)
+\left(
\frac{-k_{y,(i,j+1)}\frac{T_{i,j+1}^{n+1}-T_{i,j}^{n+1}}{\Delta{y}} 
+k_{y,(i,j)}\frac{T_{i,j}^{n+1}-T_{i,j-1}^{n+1}}{\Delta{y}}}
{\Delta{y}}
\right)
-\rho_{i,j} H_{i,j} = R_{i,j}.
\end{equation}\]</p><p>Rewriting this in a matrix-compatible form leads to: </p><p class="math-container">\[\begin{equation}
aT_{i,j-1}^{n+1} 
+bT_{i-1,j}^{n+1} 
+cT_{i,j}^{n+1} 
+dT_{i+1,j}^{n+1} 
+eT_{i,j+1}^{n+1} 
+fT_{i,j}^{n} 
-\rho_{i,j} H_{i,j} = R_{i,j},
\end{equation}\]</p><p>where</p><p class="math-container">\[\begin{equation}\begin{split}
a &amp; = -\frac{k_{y,(i,j)}}{\Delta{y^2}} \\
b &amp; = -\frac{k_{x,(i,j)}}{\Delta{x^2}} \\
c &amp; = \frac{\rho_{i,j} c_{p,(i,j)}}{\Delta{t}} 
+\frac{k_{x,(i+1,j)}}{\Delta{x^2}} + \frac{k_{x,(i,j)}}{\Delta{x^2}} 
+\frac{k_{y,(i,j+1)}}{\Delta{y^2}} + \frac{k_{y,(i,j)}}{\Delta{y^2}} \\
d &amp; = -\frac{k_{x,(i+1,j)}}{\Delta{x^2}} \\
e &amp; = -\frac{k_{y,(i,j+1)}}{\Delta{y^2}} \\
f &amp; = -\frac{\rho_{i,j} c_{p,(i,j)}}{\Delta{t}} \\
\end{split}\end{equation}\]</p><p>Additional solver (explicit, implicit, CNA) for variable thermal parameter will follow in the near future. </p><hr/><h2 id="Temperature-Field-Management"><a class="docs-heading-anchor" href="#Temperature-Field-Management">Temperature Field Management</a><a id="Temperature-Field-Management-1"></a><a class="docs-heading-anchor-permalink" href="#Temperature-Field-Management" title="Permalink"></a></h2><p>In the <strong>explicit solver</strong> and the <strong>defect correction method</strong>, the <em>extended temperature field</em>, which includes ghost nodes, is required to compute the temperature at the new time step. The current temperature values at the centroids are assigned to this extended field to serve as the <em>old</em> temperature.</p><p>For the remaining solvers, the current temperature field at the centroids is used to construct the known right-hand side vector. The corresponding coefficient matrices are assembled to solve for the unknown temperature at the next time step.</p><h1 id="Steady-State-Solution"><a class="docs-heading-anchor" href="#Steady-State-Solution">Steady State Solution</a><a id="Steady-State-Solution-1"></a><a class="docs-heading-anchor-permalink" href="#Steady-State-Solution" title="Permalink"></a></h1><p>In steady state, the temperature field does not vary with time (i.e., <span>$\partial T/\partial t = 0$</span>), and the heat equation simplifies to an <em>elliptic partial differential equation</em>, also known as the <em>Poisson equation</em>.</p><h2 id="Poisson-Equation-(Constant-k)"><a class="docs-heading-anchor" href="#Poisson-Equation-(Constant-k)">Poisson Equation (Constant <span>$k$</span>)</a><a id="Poisson-Equation-(Constant-k)-1"></a><a class="docs-heading-anchor-permalink" href="#Poisson-Equation-(Constant-k)" title="Permalink"></a></h2><p>For constant thermal conductivity, the steady-state heat equation is given by:</p><p class="math-container">\[\begin{equation}
0 = \left( 
    \frac{\partial^2 T}{\partial x^2} + \frac{\partial^2 T}{\partial z^2}
    \right) + \frac{Q}{k}.
\end{equation}\]</p><p>Using central finite differences to approximate the spatial derivatives, this becomes:</p><p class="math-container">\[\begin{equation}
0 = \left( 
\frac{T_{i-1,j} - 2T_{i,j} + T_{i+1,j}}{\Delta x^2} + \frac{T_{i,j-1} - 2T_{i,j} + T_{i,j+1}}{\Delta y^2}
\right) + \frac{Q}{k},
\end{equation}\]</p><p>where <span>$i$</span> and <span>$j$</span> denote the indices in the <span>$x$</span>- and <span>$y$</span>-directions, respectively.</p><p>Rearranging the terms yields a linear system of the form:</p><p class="math-container">\[\begin{equation} 
bT_{i,j-1} + aT_{i-1,j} - 2(a+b)T_{i,j} + aT_{i+1,j} + bT_{i,j+1} = -\frac{Q}{k},
\end{equation}\]</p><p>with</p><p class="math-container">\[\begin{equation}
a = \frac{1}{\Delta x^2}, \quad
b = \frac{1}{\Delta y^2}.
\end{equation}\]</p><h3 id="Boundary-Conditions-3"><a class="docs-heading-anchor" href="#Boundary-Conditions-3">Boundary Conditions</a><a class="docs-heading-anchor-permalink" href="#Boundary-Conditions-3" title="Permalink"></a></h3><p>Boundary conditions are enforced using ghost nodes, requiring modifications to both the coefficient matrix and the right-hand side vector.</p><p><strong>Dirichlet Boundary Conditions</strong></p><p><strong>West boundary</strong></p><p class="math-container">\[\begin{equation}
bT_{1,j-1} - (3a + 2b)T_{1,j} + bT_{1,j+1} + aT_{2,j} = -\frac{Q_{i,j}}{k_{i,j}} - 2aT_{BC,W}.
\end{equation}\]</p><p><strong>East boundary</strong></p><p class="math-container">\[\begin{equation}
aT_{ncx-1,j} + bT_{ncx,j-1} - (3a + 2b)T_{ncx,j} + bT_{ncx,j+1} = -\frac{Q_{i,j}}{k_{i,j}} - 2aT_{BC,E}.
\end{equation}\]</p><p><strong>South boundary</strong></p><p class="math-container">\[\begin{equation}
aT_{i-1,1} - (2a + 3b)T_{1,1} + bT_{i,2} + aT_{i+1,1} = -\frac{Q_{i,j}}{k_{i,j}} - 2bT_{BC,S}.
\end{equation}\]</p><p><strong>North boundary</strong></p><p class="math-container">\[\begin{equation}
aT_{i-1,ncy} + bT_{i,ncy-1} - (2a + 3b)T_{1,ncy} + aT_{i+1,ncy} = -\frac{Q_{i,j}}{k_{i,j}} - 2bT_{BC,N}.
\end{equation}\]</p><p><strong>Neumann Boundary Condtions</strong></p><p><strong>West boundary</strong></p><p class="math-container">\[\begin{equation}
bT_{1,j-1} - (a + 2b)T_{1,j} + bT_{1,j+1} + aT_{2,j} = -\frac{Q_{i,j}}{k_{i,j}} + ac_W\Delta{x}.
\end{equation}\]</p><p><strong>East boundary</strong></p><p class="math-container">\[\begin{equation}
aT_{ncx-1,j} + bT_{ncx,j-1} - (a + 2b)T_{ncx,j} + bT_{ncx,j+1} = -\frac{Q_{i,j}}{k_{i,j}} - ac_E\Delta{x}.
\end{equation}\]</p><p><strong>South boundary</strong></p><p class="math-container">\[\begin{equation}
aT_{i-1,1} - (2a + b)T_{1,1} + bT_{i,2} + aT_{i+1,1} = -\frac{Q_{i,j}}{k_{i,j}} + bc_S\Delta{y}.
\end{equation}\]</p><p><strong>North boundary</strong></p><p class="math-container">\[\begin{equation}
aT_{i-1,ncy} + bT_{i,ncy-1} - (2a + b)T_{1,ncy} + aT_{i+1,ncy} = -\frac{Q_{i,j}}{k_{i,j}} - bc_N\Delta{y}.
\end{equation}\]</p><p>For implementation details, refer to the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/HeatEquation/2Dsolvers.jl">source code</a>.</p><h2 id="Poisson-Equation-(variable-k)"><a class="docs-heading-anchor" href="#Poisson-Equation-(variable-k)">Poisson Equation (variable <span>$k$</span>)</a><a id="Poisson-Equation-(variable-k)-1"></a><a class="docs-heading-anchor-permalink" href="#Poisson-Equation-(variable-k)" title="Permalink"></a></h2><p>For spatially varying thermal conductivity, the steady-state heat equation in 2-D is given by:</p><p class="math-container">\[\begin{equation} 
0 = \frac{\partial}{\partial x}\left(k_x\frac{\partial T}{\partial x}\right) + 
\frac{\partial}{\partial y}\left(k_y\frac{\partial T}{\partial y}\right) + Q_{i,j}. 
\end{equation}\]</p><p>To discretize this equation conservatively, a staggered finite difference scheme is used: the heat flux <span>$q_i = k_i \frac{\partial T}{\partial i}$</span> is defined <strong>between</strong> centroids, while the temperature is defined <strong>at</strong> the centroids.</p><p>This yields the discretized form:</p><p class="math-container">\[\begin{equation} 
b k_{y;i,j} T_{i,j-1} + a k_{x;i,j} T_{i-1,j} + c T_{i,j} + a k_{x;i+1,j} T_{i+1,j} + b k_{y;i,j+1} T_{i,j+1} + Q_{i,j} = 0,  
\end{equation}\]</p><p>where:</p><p class="math-container">\[\begin{equation}
a = \frac{1}{\Delta{x^2}}, \quad
b = \frac{1}{\Delta{y^2}}, \textrm{and} \ \quad
c = -a\left(k_{x;i+1,j}+k_{x;i,j}\right) - b\left(k_{y;i,j+1}+k_{y;i,j}\right).
\end{equation}\]</p><p>For further implementation details, see the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/HeatEquation/2Dsolvers.jl">source code</a>.</p><hr/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../DiffOneD/">« 1D</a><a class="docs-footer-nextpage" href="../AdvectMain/">General »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 20 October 2025 10:21">Monday 20 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
