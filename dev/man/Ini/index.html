<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Initial Condition · GeoModBox.jl</title><meta name="title" content="Initial Condition · GeoModBox.jl"/><meta property="og:title" content="Initial Condition · GeoModBox.jl"/><meta property="twitter:title" content="Initial Condition · GeoModBox.jl"/><meta name="description" content="Documentation for GeoModBox.jl."/><meta property="og:description" content="Documentation for GeoModBox.jl."/><meta property="twitter:description" content="Documentation for GeoModBox.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeoModBox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Governing Equation</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox" checked/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Solution</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../GESolution/">General</a></li><li class="is-active"><a class="tocitem" href>Initial Condition</a><ul class="internal"><li><a class="tocitem" href="#Initial-Temperature"><span>Initial Temperature</span></a></li><li><a class="tocitem" href="#Initial-Velocity"><span>Initial Velocity</span></a></li><li><a class="tocitem" href="#Initial-Phase"><span>Initial Phase</span></a></li><li class="toplevel"><a class="tocitem" href="#Tracer-Calculations"><span>Tracer Calculations</span></a></li><li class="toplevel"><a class="tocitem" href="#Mutable-Structures"><span>Mutable Structures</span></a></li><li><a class="tocitem" href="#Geometry"><span>Geometry</span></a></li><li><a class="tocitem" href="#Physics"><span>Physics</span></a></li><li><a class="tocitem" href="#Grid-Spacing"><span>Grid Spacing</span></a></li><li><a class="tocitem" href="#Data-Fields"><span>Data Fields</span></a></li><li><a class="tocitem" href="#Time-Parameter"><span>Time Parameter</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Heat Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../DiffMain/">General</a></li><li><a class="tocitem" href="../DiffOneD/">1D</a></li><li><a class="tocitem" href="../DiffTwoD/">2D</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Advection Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../AdvectMain/">General</a></li><li><a class="tocitem" href="../AdvOneD/">1D</a></li><li><a class="tocitem" href="../AdvTwoD/">2D</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Momentum Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../MomentumMain/">General</a></li><li><a class="tocitem" href="../MomentumOneD/">1D</a></li><li><a class="tocitem" href="../MomentumTwoD/">2D</a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../Examples/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/OceanicGeotherm/">Oceanic Geotherm (1D)</a></li><li><a class="tocitem" href="../examples/ContinentalGeotherm/">Continental Geotherm (1D)</a></li><li><a class="tocitem" href="../examples/GaussianDiffusion1D/">Gaussian Diffusion (1D)</a></li><li><a class="tocitem" href="../examples/BackwardEuler_DC/">Backward Euler (2D)</a></li><li><a class="tocitem" href="../examples/ForwardEuler_DC/">Forward Euler (2D)</a></li><li><a class="tocitem" href="../examples/GaussianDiffusion2D/">Gaussian Diffusion (2D)</a></li><li><a class="tocitem" href="../examples/PoissonRestest/">Poisson Problem (2D)</a></li><li><a class="tocitem" href="../examples/PoissonVariablek/">Poisson Problem; variable k (2D)</a></li></ul></li></ul></li><li><a class="tocitem" href="../listoffunctions/">List of functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Governing Equation</a></li><li><a class="is-disabled">Solution</a></li><li class="is-active"><a href>Initial Condition</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Initial Condition</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GeoSci-FFM/GeoModBox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/docs/src/man/Ini.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Initial-Conditions"><a class="docs-heading-anchor" href="#Initial-Conditions">Initial Conditions</a><a id="Initial-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-Conditions" title="Permalink"></a></h1><p><code>GeoModBox.jl</code> includes several <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/InitialCondition/2Dini.jl">routines</a> or <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/Structures.jl">structures</a> to define certain parameters or initialize specific anomalies. The initial conditions can be specified for properties defined on their corresponding grid (i.e., temperature, velocity, or phase) or for tracers. </p><h2 id="Initial-Temperature"><a class="docs-heading-anchor" href="#Initial-Temperature">Initial Temperature</a><a id="Initial-Temperature-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-Temperature" title="Permalink"></a></h2><pre><code class="language-julia hljs">IniTemperature!(type,M,NC,D,x,y;Tb=600.0,Ta=1200.0,σ=0.1)</code></pre><p>Currently, there are five different initial temperature conditions available: </p><ol><li>A circular anomaly with a constant background (<code>circle</code>)</li><li>A Gaussian anomaly (<code>gaussian</code>)</li><li>A rectangular shaped anomaly with a constant background (<code>block</code>)</li><li>A linear increasing temperature with depth (<code>linear</code>)</li><li>A linear increasing temperature with depth including an elliptical anomaly (<code>lineara</code>)</li></ol><p>The input parameters are: </p><ul><li>type - Parameter defining the type (see above)</li><li>M - Structure or tuple containing the geometry</li><li>NC - Structure or tuple containing the centroids parameter </li><li>D - Structure or tuple containing the field arrays</li><li>x - Structure or tuple containing the x-coordinates</li><li>y - tructure or tuple containing the y-coordinates</li></ul><p>Certain default values can be modified as well: </p><ul><li>Tb - Scalar value for the background temperature</li><li>Ta - Scalar value for the maximum (anomaly) temperature</li><li><p class="math-container">\[\sigma\]</p><ul><li>Width of the Gaussian temperature anomaly</li></ul></li></ul><p>The temperature is initialized on the extended centroid grid. The corresponding field without <em>ghost nodes</em> is updated accordingly.</p><p>The function is called, for example, like <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/examples/MixedHeatedConvection/BottomHeated.jl">here</a>: </p><pre><code class="language-Julia hljs">IniTemperature!(Ini.T,M,NC,D,x,y;Tb=P.Tbot,Ta=P.Ttop)</code></pre><h2 id="Initial-Velocity"><a class="docs-heading-anchor" href="#Initial-Velocity">Initial Velocity</a><a id="Initial-Velocity-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-Velocity" title="Permalink"></a></h2><pre><code class="language-julia hljs">IniVelocity!(type,D,NV,Δ,M,x,y)</code></pre><p>Two initial velocity configurations are currently supported: </p><ol><li>A rigid-body rotation (<code>RigidBody</code>)</li><li>A shear cell (<code>ShearCell</code>)</li></ol><p>The input parameters are: </p><ul><li>type - Parameter defining the type (see above)</li><li>D - Structure or tuple containing the field arrays</li><li>NV - Structure or tuple containing the vertices parameter </li><li><p class="math-container">\[\Delta\]</p><ul><li>Structure or tuple containing the grid resolution</li></ul></li><li>M - Structure or tuple containing the geometry</li><li>x - Structure or tuple containing the x-coordinates</li><li>y - tructure or tuple containing the y-coordinates</li></ul><p>The function is called, for example, like <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/examples/AdvectionEquation/2D_Advection.jl">here</a>: </p><pre><code class="language-Julia hljs">IniVelocity!(Ini.V,D,NV,Δ,M,x,y)</code></pre><h2 id="Initial-Phase"><a class="docs-heading-anchor" href="#Initial-Phase">Initial Phase</a><a id="Initial-Phase-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-Phase" title="Permalink"></a></h2><pre><code class="language-julia hljs">IniPhase!(type,D,M,x,y,NC;phase=0)</code></pre><p>Currently, only one initial phase configuration is available: </p><ol><li>A rectangular shaped anomaly (<code>block</code>)</li></ol><p>The input parameters are: </p><ul><li>type - Parameter defining the type (see above)</li><li>D - Structure or tuple containing the field arrays</li><li>M - Structure or tuple containing the geometry</li><li>x - Structure or tuple containing the x-coordinates</li><li>y - Structure or tuple containing the y-coordinates</li><li>NC - Structure or tuple containing the centroids parameter</li></ul><p>Certain default values can be modified as well: </p><ul><li>phase - Vector containing the phase ID numbers (e.g. phase=[0,1])</li></ul><p>The phase is initialized on the extended centroid grid. The corresponding field without <em>ghost nodes</em> is updated accordingly.</p><p>The function is called, for example, like <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/examples/StokesEquation/2D/FallingBlockBenchmark.jl">here</a>: </p><pre><code class="language-Julia hljs">IniPhase!(Ini.p,D,M,x,y,NC;phase)</code></pre><p>The density on the extended, centroid grid is then, for example, updated via the phase ID: </p><pre><code class="language-julia hljs">for i in eachindex(phase)
    D.ρ[D.p.==phase[i]] .= ρ[i]
end</code></pre><h1 id="Tracer-Calculations"><a class="docs-heading-anchor" href="#Tracer-Calculations">Tracer Calculations</a><a id="Tracer-Calculations-1"></a><a class="docs-heading-anchor-permalink" href="#Tracer-Calculations" title="Permalink"></a></h1><p>Because tracer advection can be performed in parallel, additional parameters must be defined. However, <code>GeoModBox.jl</code> provides functionality to initialize tracer positions and rectangular phase anomalies, if needed. Additional initial configuration methods are encouraged and can be integrated. </p><p>The following steps are required to use tracers: </p><p><strong>1. Tracer initialization</strong></p><p>To initialize the tracers, one needs to define the number per cell, wanted noise, and what property should be advected.</p><p>Following the definition of the required parameters for the tracer advection, the initial tracer position can be defined via the function </p><pre><code class="language-julia hljs">IniTracer2D(Aparam,nmx,nmy,Δ,M,NC,noise,ini,phase)</code></pre><p>The function initializes the position and the memory of the tracers. </p><p>The input parameters are: </p><ul><li>Aparam - defines if temperature (<code>thermal</code>) or phase (<code>phase</code>) is advected</li><li>nmx - number of horizontal tracers per cell</li><li>nmy - number of vertical tracers per cell</li><li><p class="math-container">\[\Delta\]</p><ul><li>Structure or tuple containing the grid resolution</li></ul></li><li>M - Structure or tuple containing the geometry</li><li>NC - Structure or tuple containing centroids parameter</li><li>noise - add noise; 1 - yes, 0 - no</li><li>ini - Initial phase distribution (<code>block</code>)</li><li>phase - Vector with phase IDs, (e.g. [0,1])</li></ul><p>To advect the temperature, the initialization is called, for example, like <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/examples/AdvectionEquation/2D_Advection.jl">here</a>: </p><pre><code class="language-julia hljs"># Tracer Initialization ---
nmx,nmy     =   3,3         # tracer per cell in x and y direction
noise       =   1           # add noise to the initial position
nmark       =   nmx*nmy*NC.x*NC.y   # total number of tracers
Aparam      =   :thermal    # Property to be advected
# Tuple required for the tracer count 
MPC         =   (
    c       =   zeros(Float64,(NC.x,NC.y)),             # per centroid
    v       =   zeros(Float64,(NV.x,NV.y)),             # per vertices
    th      =   zeros(Float64,(nthreads(),NC.x,NC.y)),  # per thread
    thv     =   zeros(Float64,(nthreads(),NV.x,NV.y)),  # per thread
)
# Tuple for the tracer count and the weighting
MPC1        = (
    PG_th   =   [similar(D.T) for _ = 1:nthreads()],        # per thread
    PV_th   =   [similar(D.wtv) for _ = 1:nthreads()],      # per thread
    wt_th   =   [similar(D.wt) for _ = 1:nthreads()],       # per thread
    wtv_th  =   [similar(D.wtv) for _ = 1:nthreads()],      # per thread
)
MPC     =   merge(MPC,MPC1)
# Function to initialize tracer distribution
Ma      =   IniTracer2D(Aparam,nmx,nmy,Δ,M,NC,noise,0,0)
# RK4 weights ---
rkw     =   1.0/6.0*[1.0 2.0 2.0 1.0]   # for averaging
rkv     =   1.0/2.0*[1.0 1.0 2.0 2.0]   # for time stepping
# Interpolate on centroids ---
@threads for k = 1:nmark
    Ma.T[k] =   FromCtoM(D.T_ex, k, Ma, x, y, Δ, NC)
end
# Count tracer per cell ---
CountMPC(Ma,nmark,MPC,M,x,y,Δ,NC,NV,1)</code></pre><p>To advect the phase, the initialization is called, for example, like <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/examples/StokesEquation/2D/FallingBlockVarEta_DC.jl">here</a>: </p><pre><code class="language-julia hljs"># Tracer Advection ================================================== #
nmx,nmy     =   3,3
noise       =   0
nmark       =   nmx*nmy*NC.x*NC.y
Aparam      =   :phase
MPC         =   (
    c       =   zeros(Float64,(NC.x,NC.y)),
    v       =   zeros(Float64,(NV.x,NV.y)),
    th      =   zeros(Float64,(nthreads(),NC.x,NC.y)),
    thv     =   zeros(Float64,(nthreads(),NV.x,NV.y)),
)
MPC1        = (
    PG_th   =   [similar(D.ρ) for _ = 1:nthreads()],    # per thread
    PV_th   =   [similar(D.ηv) for _ = 1:nthreads()],   # per thread
    wt_th   =   [similar(D.wt) for _ = 1:nthreads()],   # per thread
    wtv_th  =   [similar(D.wtv) for _ = 1:nthreads()],  # per thread
)
MPC     =   merge(MPC,MPC1)
Ma      =   IniTracer2D(Aparam,nmx,nmy,Δ,M,NC,noise,Ini.p,phase)
# RK4 weights ---
rkw     =   1.0/6.0*[1.0 2.0 2.0 1.0]   # for averaging
rkv     =   1.0/2.0*[1.0 1.0 2.0 2.0]   # for time stepping
# Count tracer per cell ---
CountMPC(Ma,nmark,MPC,M,x,y,Δ,NC,NV,1)
# Interpolate from tracers to cell ---
Markers2Cells(Ma,nmark,MPC.PG_th,D.ρ,MPC.wt_th,D.wt,x,y,Δ,Aparam,ρ)
Markers2Cells(Ma,nmark,MPC.PG_th,D.p,MPC.wt_th,D.wt,x,y,Δ,Aparam,phase)
Markers2Vertices(Ma,nmark,MPC.PV_th,D.ηv,MPC.wtv_th,D.wtv,x,y,Δ,Aparam,η)
@. D.ηc     =   0.25 * (D.ηv[1:end-1,1:end-1] + 
                        D.ηv[2:end-0,1:end-1] + 
                        D.ηv[1:end-1,2:end-0] + 
                        D.ηv[2:end-0,2:end-0])</code></pre><p><strong>2. Tracer advection</strong> </p><p>The tracers are advected using Runge-Kutta 4th order. This is conducted using the function</p><pre><code class="language-julia hljs">AdvectTracer2D(Ma,nmark,D,x,y,dt,Δ,NC,rkw,rkv,style)</code></pre><p>The input parameters are: </p><ul><li>Ma - Structure containing the tracer information</li><li>nmark - Total number of tracers</li><li>D - Structure or tuple containing the field arrays</li><li>x - Structure or tuple containing the x-coordinates</li><li>y - Structure or tuple containing the y-coordinates</li><li>dt - Time step</li><li><p class="math-container">\[\Delta\]</p><ul><li>Structure or tuple containing the grid resolution</li></ul></li><li>NC - Structure or tuple containing the centroids parameter</li><li>rkw - Runge-Kutta weights for averaging</li><li>rkv - Runge-Kutta weights for time stepping</li><li>style - Defines which velocity is used for the advection</li></ul><p>For more details please refer to the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/Tracers/2Dsolvers.jl">source code</a>.</p><blockquote><p><strong>Note:</strong> Currently, temperature is not intended to be advected via tracers, as this would require the update of the tracer temperature via incremental changes rather than absolute value. Within the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/examples/AdvectionEquation/2D_Advection.jl">2-D advection example</a> temperature advection is only used assuming non-diffusive process. Thus, no update of the tracer temperature is required! </p></blockquote><p>The advection of temperature and the update of the temperature field on the centroids is called, for example, like <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/examples/AdvectionEquation/2D_Advection.jl">here</a>: </p><pre><code class="language-julia hljs"># Advect tracers ---
AdvectTracer2D(Ma,nmark,D,x,y,T.Δ[1],Δ,NC,rkw,rkv,1)
# CountMPC(Ma,nmark,MPC,M,x,y,Δ,NC,i)
CountMPC(Ma,nmark,MPC,M,x,y,Δ,NC,NV,i)
     
# Interpolate temperature from tracers to grid ---
Markers2Cells(Ma,nmark,MPC.PG_th,D.T,MPC.wt_th,D.wt,x,y,Δ,Aparam,0)           
D.T_ex[2:end-1,2:end-1]     .= D.T</code></pre><p>The advection of the phase and the update of the corresponding grid parameters is called, for example, like <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/examples/StokesEquation/2D/FallingBlockVarEta_DC.jl">here</a>: </p><pre><code class="language-julia hljs"># Advection ===
# Advect tracers ---
@printf(&quot;Running on %d thread(s)\n&quot;, nthreads())  
AdvectTracer2D(Ma,nmark,D,x,y,T.Δ[1],Δ,NC,rkw,rkv,1)
CountMPC(Ma,nmark,MPC,M,x,y,Δ,NC,NV,it)

# Update grid parameters from tracers distributions ---
Markers2Cells(Ma,nmark,MPC.PG_th,D.ρ,MPC.wt_th,D.wt,x,y,Δ,Aparam,ρ)
Markers2Cells(Ma,nmark,MPC.PG_th,D.p,MPC.wt_th,D.wt,x,y,Δ,Aparam,phase)
Markers2Vertices(Ma,nmark,MPC.PV_th,D.ηv,MPC.wtv_th,D.wtv,x,y,Δ,Aparam,η)
@. D.ηc     =   0.25 * (D.ηv[1:end-1,1:end-1] + 
                    D.ηv[2:end-0,1:end-1] + 
                    D.ηv[1:end-1,2:end-0] + 
                    D.ηv[2:end-0,2:end-0])</code></pre><blockquote><p><strong>Note:</strong> The tracer distribution and interpolation of tracer properties to the centroids or vertices is a very helpful feature to initialize different, more complex model setups. This will be part of future implementations. </p></blockquote><h1 id="Mutable-Structures"><a class="docs-heading-anchor" href="#Mutable-Structures">Mutable Structures</a><a id="Mutable-Structures-1"></a><a class="docs-heading-anchor-permalink" href="#Mutable-Structures" title="Permalink"></a></h1><p>Implementation of scaled thermal convection models in <code>GeoModBox.jl</code> revealed that immutable <code>NamedTuples</code> can be numerically limiting. Some initially defined parameters, like the model height, need to be modified in order to scale them. Thus, mutable structures (<code>mutable struct</code>) have been included. Luckily, the functions do not distinguish between a <code>NamedTuple</code> and a <code>mutable struct</code> in <code>Julia</code>. Thus, no additional modification in the functions are required. </p><p>Mutable structures are designed so that all necessary parameters are initialized with default values. To ensure that the default values are picked if no input parameter is used calling the <code>mutable struct</code> the option <code>@kwdef</code> needs to be added when initializing the structure. For more details on this please refer to the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/Structures.jl">source code</a>.</p><p>The following, for example, initializes a mutable structure using only the default values </p><pre><code class="language-julia hljs">M = Geometry()</code></pre><p>If one wants to modify certain parameters within the structure, one needs to call the function like: </p><pre><code class="language-julia hljs">M = Geometry(
    ymax    =   1.0,        # [ m ]
    ymin    =   0.0,        # [ m ]
)</code></pre><p>This initializes a box with a minimum and maximum depth of 0.0 [m] and 1.0 [m], respectively. The remaining parameters are defined by their default values. </p><p>The following mutable structures including their default values are currently available: </p><h2 id="Geometry"><a class="docs-heading-anchor" href="#Geometry">Geometry</a><a id="Geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Geometry" title="Permalink"></a></h2><pre><code class="language-julia hljs">M = Geometry(
    xmin    = 0.0,              # Minimum x-coordinate [ m ]
    xmax    = 1.0,              # Maximum x-coordinate [ m ]
    ymin    = -1.0,             # Minimum y-coordinate [ m ]
    ymax    = 0.0,              # Maximum y-coordinate [ m ]
)</code></pre><h2 id="Physics"><a class="docs-heading-anchor" href="#Physics">Physics</a><a id="Physics-1"></a><a class="docs-heading-anchor-permalink" href="#Physics" title="Permalink"></a></h2><pre><code class="language-julia hljs">P = Physics(
    g       = 9.81,             # Gravitational acceleration [ m/s² ]
    ρ₀      = 3300.0,           # Reference density [ kg/m³ ]
    k       = 4.125,            # Thermal conductivity [ W/m/K ]
    cp      = 1250.0,           # Specific heat capacity [ J/kg/K ]
    α       = 2.0e-5,           # Thermal expansion coefficient [ 1/K ]
    Q₀      = 0.0,              # Heat production rate [ W/m³ ]
    η₀      = 3.947725485e23,   # Reference viscosity [ Pa s ]
    κ       = k/ρ₀/cp,          # Thermal Diffusivity [ m²/s ]    
    ΔT      = 2500,             # Temperature difference [ K ]
    Ttop    = 273.15,           # Temperature at the top [ K ]
    Tbot    = Ttop + ΔT,        # Temperature at the bottom [ K ] 
    Ra      = 1e5,              # Rayleigh number
)</code></pre><h2 id="Grid-Spacing"><a class="docs-heading-anchor" href="#Grid-Spacing">Grid Spacing</a><a id="Grid-Spacing-1"></a><a class="docs-heading-anchor-permalink" href="#Grid-Spacing" title="Permalink"></a></h2><pre><code class="language-julia hljs">Δ = GridSpacing(
    x   =   0.0,                # Horizontal grid resolution 
    y   =   0.0,                # Vertical grid resolution
)</code></pre><h2 id="Data-Fields"><a class="docs-heading-anchor" href="#Data-Fields">Data Fields</a><a id="Data-Fields-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Fields" title="Permalink"></a></h2><pre><code class="language-julia hljs">D = DataFields(
    Q       = zeros(1,1),
    T       = zeros(1,1),
    T0      = zeros(1,1),
    T_ex    = zeros(1,1),
    T_exo   = zeros(1,1),
    ρ       = zeros(1,1),
    cp      = zeros(1,1),
    vx      = zeros(1,1),
    vy      = zeros(1,1),
    Pt      = zeros(1,1),
    vxc     = zeros(1,1),
    vyc     = zeros(1,1),
    vc      = zeros(1,1),
    wt      = zeros(1,1),
    wtv     = zeros(1,1),
    ΔTtop   = zeros(1),
    ΔTbot   = zeros(1),
    Tmax    = 0.0,
    Tmin    = 0.0,
    Tmean   = 0.0,
end
)</code></pre><p>If the default value for a field is used, an empty array is initialized to save memory. </p><h2 id="Time-Parameter"><a class="docs-heading-anchor" href="#Time-Parameter">Time Parameter</a><a id="Time-Parameter-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Parameter" title="Permalink"></a></h2><pre><code class="language-julia hljs">T = TimeParameter(
    const year  =   365.25*3600*24,      #   Seconds per year
    tmax        =   1000.0,              #   [ Ma ]
    Δfacc       =   0.9,                 #   Courant time factor
    Δfacd       =   0.9,                 #   Diffusion time factor
    Δ           =   0.0,                 #   Absolute time step
    Δc          =   0.0,                 #   Courant time step
    Δd          =   0.0,                 #   Diffusion time stability criterion
    itmax       =   8000,                #   Maximum iterations; 30000
)</code></pre><p>Additional mutable structure will be added. For more details on the mutable structures, please refer to the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/Structures.jl">source code</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../GESolution/">« General</a><a class="docs-footer-nextpage" href="../DiffMain/">General »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Tuesday 17 June 2025 14:22">Tuesday 17 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
