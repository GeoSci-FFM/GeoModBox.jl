<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>1D · GeoModBox.jl</title><meta name="title" content="1D · GeoModBox.jl"/><meta property="og:title" content="1D · GeoModBox.jl"/><meta property="twitter:title" content="1D · GeoModBox.jl"/><meta name="description" content="Documentation for GeoModBox.jl."/><meta property="og:description" content="Documentation for GeoModBox.jl."/><meta property="twitter:description" content="Documentation for GeoModBox.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeoModBox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Governing Equation</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Solution</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../GESolution/">General</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Heat Diffusion Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../DiffMain/">General</a></li><li><a class="tocitem" href="../DiffOneD/">1D</a></li><li><a class="tocitem" href="../DiffTwoD/">2D</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Momentum Equation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../MomentumMain/">General</a></li><li class="is-active"><a class="tocitem" href>1D</a><ul class="internal"><li><a class="tocitem" href="#Discretization"><span>Discretization</span></a></li></ul></li><li><a class="tocitem" href="../MomentumTwoD/">2D</a></li></ul></li></ul></li><li><a class="tocitem" href="../listoffunctions/">List of functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Governing Equation</a></li><li><a class="is-disabled">Momentum Equation</a></li><li class="is-active"><a href>1D</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>1D</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GeoSci-FFM/GeoModBox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/docs/src/man/MomentumOneD.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Stokes-Equation-(1D)"><a class="docs-heading-anchor" href="#Stokes-Equation-(1D)">Stokes Equation (1D)</a><a id="Stokes-Equation-(1D)-1"></a><a class="docs-heading-anchor-permalink" href="#Stokes-Equation-(1D)" title="Permalink"></a></h1><p>Before solving the <em>stokes equation</em> in two dimensions, let&#39;s first start with a simpler, one-dimensional problem: an uniaxial stokes flow in a horizontal channel assuming a known horizontal pressure gradient. A flow like this is a very good, first order approximation of a flow in a magma or subduction channel. The <em>stokes equation</em> in one dimension is defined as (e.g., in the <span>$x$</span>-direction):  </p><p><em><span>$x$</span>-component</em></p><p class="math-container">\[\begin{equation}
0 = -\frac{\partial{P}}{\partial{x}} + \frac{\partial{\tau_{xy}}}{\partial{y}},
\end{equation}\]</p><p>where <span>$P$</span> is the pressure in [ <span>$Pa$</span> ], <span>$\frac{\partial}{\partial{x_i}}$</span> is the partial derivative in the <span>$i$</span>-th direction, and <span>$\tau_{xy}$</span> is the horizontal shear stress in [ <span>$Pa$</span> ] and given by: </p><p class="math-container">\[\begin{equation}
\tau_{xy} = 2 \eta \dot{\varepsilon}_{xy},
\end{equation}\]</p><p>where <span>$\eta$</span> is the viscosity in [ <span>$Pa s$</span> ] and <span>$\dot{\varepsilon}_{xy}$</span> is the shear strain-rate in [ <span>$m/s$</span> ] and given by: </p><p class="math-container">\[\begin{equation}
\dot{\varepsilon}_{xy} = \frac{1}{2} \frac{\partial{v_x}}{\partial{y}}.
\end{equation}\]</p><p><strong>Note:</strong> For the <span>$y$</span>-component of the <em>stokes equation</em> one need to include the gravitational acceleration <span>$g_y$</span>. </p><h2 id="Discretization"><a class="docs-heading-anchor" href="#Discretization">Discretization</a><a id="Discretization-1"></a><a class="docs-heading-anchor-permalink" href="#Discretization" title="Permalink"></a></h2><p><img src="../../assets/Stokes_1D_Grid.png" alt="Stokes1D_Grid"/></p><p><strong>Figure 1.</strong> <strong>Channel flow setup and finite difference grid.</strong> <em>Left</em>: Sketch of an uniaxial channel flow driven by a constant velocity on top (<span>$v_x$</span>) and/or a horizontal pressure gradient <span>$\left(\frac{\Delta{P}}{\Delta{x}} = P_1 - P_0 \right)$</span>, that is a Couette, Poiseuille, or Couette-Poiseuille flow. <em>Right</em>: Finite difference grid using a conservative gridding, that is the viscosity is defined on the <em>vertices</em> and the horizontal velocity in between. The open circles at the top are <em>ghost nodes</em> for the horizontal velocity. </p><p>The finite difference grid shown in Figure 1 is a conservative gridding, that is the horizontal velocity is defined at different nodes as the viscosity. Thus, the horizontal shear stress is conserved between two adjacent grid points and defined on the <em>vertices</em>. A conservative gridding is required in case the viscosity does vary with depth. Before solving the problem for a variable, depth-dependent viscosity, let&#39;s first look at an isoviscous case.</p><p>***Constant Viscosity***</p><p>In case the viscosity is constant, a conservative gridding is not necessary. Equation <span>$(1)$</span> is then given by: </p><p class="math-container">\[\begin{equation}
0 = -\frac{\partial{P}}{\partial{x}} + \eta\frac{\partial^2{v_x}}{\partial{y^2}}.
\end{equation}\]</p><p>Using the finite difference approximations for the partial derivatives (second derivative, central differences), equation <span>$(4)$</span> is given as (assuming the horizontal pressure gradient is constant and known): </p><p class="math-container">\[\begin{equation}
\frac{\partial{P}}{\partial{x}} = \eta \left( \frac{v_{x,j-1} - 2v_{x,j} + v_{x,j+1}}{\Delta{y^2}} \right),
\end{equation}\]</p><p>which can be simplified to: </p><p class="math-container">\[\begin{equation}
\frac{\partial{P}}{\partial{x}}=av_{x,j-1}+bv_{x,j}+cv_{x,j+1}, 
\end{equation}\]</p><p>where</p><p class="math-container">\[a = c = \frac{\eta}{\Delta{y^2}},\ \textrm{and}\ b = -\frac{2\eta}{\Delta{y^2}}.\]</p><p>This is a linear system of equations in the form of <span>$\bold{K} \cdot \overrightharpoon{v_x} = \overrightharpoon{rhs}$</span> with a three-diagonal coefficient matrix <span>$\bold{K}$</span>. The pressure gradient and the velocities at the boundaries define the known right-hand side (rhs) and the horizontal velocity in between the <em>vertices</em> are the unknown vector. For the sake of simplicity, no additional solver for the constant velocity case is included in the <code>GeoModBox.jl</code>, thus the viscosity needs to be treated numerically as an array and not as a scalar. For more information on how this is implemented see the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/MomentumEquation/1Dsolvers.jl">source code</a>.</p><p>***Variable Viscosity***</p><p>In case of a variable viscosity, equation <span>$(1)$</span> is given by: </p><p class="math-container">\[\begin{equation}
0 = -\frac{\partial{P}}{\partial{x}} + \frac{\partial{\tau_{xy}}}{\partial{y}} = -\frac{\partial{P}}{\partial{x}} + \frac{\partial}{\partial{y}}\left(\eta\frac{\partial{v_x}}{\partial{y}}\right).
\end{equation}\]</p><p>The partial difference operators (first derivatives) in Equation <span>$(7)$</span> are approximated using central finite differences, where the horizontal shear stress <span>$\tau_{xy}$</span> and the viscosity are defined at the <em>vertices</em> and the velocity in between (for the sake of simplcity, let&#39;s call it the <em>centroids</em> in the 1-D case). </p><p>Using central difference for the shear stress, Equation <span>$(7)$</span> is given by: </p><p class="math-container">\[\begin{equation}
\frac{\partial{P}}{\partial{x}}=\frac{\tau_{xy,j+1}-\tau_{xy,j}}{\Delta{y}},\ \textrm{for}\ j = 1:nc, 
\end{equation}\]</p><p>or in form of the unknowns: </p><p class="math-container">\[\begin{equation}
\frac{\partial{P}}{\partial{x}}=\frac{\eta_{j+1}\frac{\partial{v_x}}{\partial{y}}\vert_{j+1}-\eta_{j}\frac{\partial{v_x}}{\partial{y}}\vert_{j}}{\Delta{y}},\ \textrm{for}\ j = 1:nc.
\end{equation}\]</p><p>Approximating the partial derivatives for the velocity results in: </p><p class="math-container">\[\begin{equation}
\frac{\partial{P}}{\partial{x}}=\frac{\eta_{j+1}\frac{v_{x,j+1}-v_{x,j}}{\Delta{y}}-\eta_{j}\frac{v_{x,j}-v_{x,j-1}}{\Delta{y}}\vert_{j}}{\Delta{y}}.
\end{equation}\]</p><p><strong>Note</strong>: The index <span>$j$</span> goes from <span>$1$</span> to <span>$nc$</span>, but the viscosity is defined on the <em>vertices</em> and the velocity on the <em>centroids</em>! </p><p>In terms of the unknown velocity, equation <span>$(10)$</span> can be rewritten as: </p><p class="math-container">\[\begin{equation}
\frac{\partial{P}}{\partial{x}}=av_{x,j-1}+bv_{x,j}+cv_{x,j+1}, 
\end{equation}\]</p><p>where</p><p class="math-container">\[\begin{equation}
a = \frac{\eta_j}{\Delta{y^2}}, b = -\frac{\eta_j+\eta_{j+1}}{\Delta{y^2}},\ \textrm{and}\ c = \frac{\eta_{j+1}}{\Delta{y^2}}. 
\end{equation}\]</p><p>Again, this is a linear system of equations with a three-diagonal coefficient matrix.  </p><h3 id="Boundary-Conditions"><a class="docs-heading-anchor" href="#Boundary-Conditions">Boundary Conditions</a><a id="Boundary-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-Conditions" title="Permalink"></a></h3><p>To solve the equations, one needs to define the boundary conditions. To properly implement <em>Dirichlet</em> and <em>Neumann</em> boundary conditions, one needs to describe the velocity at the <em>ghost nodes</em>. Similar to the thermal boundary conditions, the value for the velocity at the <em>ghost nodes</em> can be defined assuming a constant velocity at the boundary (i.e., <em>Dirichlet</em>) or a constant velocity gradient across the boundary (i.e., <em>Neumann</em>). The velocites are then defined as: </p><p><strong>Dirichlet</strong></p><p><em>Bottom</em></p><p class="math-container">\[\begin{equation}
V_{G,S} = 2V_{BC,S} - v_{x,1}
\end{equation}\]</p><p><em>Top</em></p><p class="math-container">\[\begin{equation}
V_{G,N} = 2V_{BC,N} - v_{x,nc}
\end{equation}\]</p><p><strong>Neumann</strong></p><p><em>Bottom</em></p><p class="math-container">\[\begin{equation}
V_{G,S} = v_{x,1} - c_s\Delta{y},
\end{equation}\]</p><p><em>Top</em></p><p class="math-container">\[\begin{equation}
V_{G,N}=v_{x,nc} + c_N\Delta{y},
\end{equation}\]</p><p>where </p><p class="math-container">\[\begin{equation}
c_S = \frac{dv_x}{dy}\vert_{S},\ \textrm{and}\ c_N=\frac{dv_x}{dy}\vert_{N}
\end{equation}\]</p><p>To obtain a symmetric coefficient matrix one needs to adjust the coefficients for the <em>centroids</em> adjacent to the boundary and the corresponding right-hand side. The equations at the top and bottom are then given by:  </p><p><strong>Dirichlet</strong></p><p><em>Bottom</em> (<span>$j=1$</span>)</p><p class="math-container">\[\begin{equation}
\left(b-a\right)v_{x,1}+cv_{x,2} = \frac{\partial{P}}{\partial{x}} - 2aV_{BC,S}
\end{equation}\]</p><p><em>Top</em> (<span>$j=nc$</span>)</p><p class="math-container">\[\begin{equation}
av_{x,nc-1}+\left(b-c\right)v_{x,nx} = \frac{\partial{P}}{\partial{x}} - 2cV_{BC,N}
\end{equation}\]</p><p><strong>Neumann</strong></p><p><em>Bottom</em> (<span>$j=1$</span>)</p><p class="math-container">\[\begin{equation}
\left(b+a\right)v_{x,1}+cv_{x,2} = \frac{\partial{P}}{\partial{x}} + ac_SΔy
\end{equation}\]</p><p><em>Top</em> (<span>$j=nc$</span>)</p><p class="math-container">\[\begin{equation}
av_{x,nc-1}+\left(b+c\right)v_{x,nx} = \frac{∂P}{∂x} - cc_NΔy
\end{equation}\]</p><h3 id="Solution"><a class="docs-heading-anchor" href="#Solution">Solution</a><a id="Solution-1"></a><a class="docs-heading-anchor-permalink" href="#Solution" title="Permalink"></a></h3><p>There are different ways to solve the linear system of equations. The most convenient one would be a direct solution using the right division of the coefficient matrix by the right-hand side. </p><p><strong>Direct</strong></p><p class="math-container">\[\begin{equation}
v_x = \bold{K} ∖ rhs
\end{equation}\]</p><p>Similar to the thermal problem, one can also solve the linear system of equations using the defect correction method. This is very helpful, once the system is non-linear and one can simply iterate to reduce the residual. </p><p><strong>Defect Correction</strong></p><p>Here, one first calculates the residual of the governing equation: </p><p class="math-container">\[\begin{equation}
R = -\frac{∂P}{∂x} + \frac{∂τ_{xy}}{∂y},
\end{equation}\]</p><p>or in form of the unknown horizontal velocity:</p><p class="math-container">\[\begin{equation}
R = -\frac{∂P}{∂x} + \bold{K} \cdot v_x. 
\end{equation}\]</p><p>Assuming an initial guess for the horizontal velocity <span>$v_{x,i}$</span> one obtains an initial residual <span>$R_i$</span>: </p><p class="math-container">\[\begin{equation}
R_i = -\frac{∂P}{∂x} + \bold{K_i} \cdot v_{x,i}.
\end{equation}\]</p><p>Let&#39;s assume that the initial guess leads to the exact solution, i.e. the residual is zero, by adding a correction term <span>$\delta{v_x}$</span>. With a little algebra one finds: </p><p class="math-container">\[\begin{equation}
0 = -\frac{∂P}{∂x} + \bold{K}\left(v_{x,i}+ \delta{v_x} \right) = \bold{K}\cdot v_{x,i} -\frac{∂P}{∂x} + \bold{K}\cdot \delta{v_x} = R_i + \bold{K} \cdot \delta{v_x}.
\end{equation}\]</p><p>Rearanging the equation to: </p><p class="math-container">\[\begin{equation}
R_i = -\bold{K}\cdot{\delta{v_x}}, 
\end{equation}\]</p><p>one can solve for the correction term: </p><p class="math-container">\[\begin{equation}
\delta{v_x} = -\bold{K}^{-1}R_i. 
\end{equation}\]</p><p>Finally, adding the correction term to the initial guess gives the solution: </p><p class="math-container">\[\begin{equation}
v_x^n = v_{x,i} + \delta{v_x}.
\end{equation}\]</p><p>In case the system is linear, this would be the solution for the problem. For a non-linear problem, one needs to iterate over the equation until the residual is small enough. For more information on how this is implemented see the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/src/MomentumEquation/1Dsolvers.jl">source code</a>.</p><p>How to solve the channel flow problem using the defect correction method is given within the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/examples/StokesEquation/1D/ChannelFlow_1D.jl">examples</a>. </p><p>Solving the same issue using the direct solution is part of the <a href="https://github.com/GeoSci-FFM/GeoModBox.jl/blob/main/exercises/08_1D_Stokes.ipynb">exercises</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../MomentumMain/">« General</a><a class="docs-footer-nextpage" href="../MomentumTwoD/">2D »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Thursday 8 May 2025 13:21">Thursday 8 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
